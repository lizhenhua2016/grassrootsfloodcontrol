(function(n){var u={},e={},o={},s={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},c=function(n){var t=data.getRoot(n);t||(t={},data.setRoot(n,t));t[n.data.key.children]=[];t.expandTriggerFlag=!1;t.curSelectedList=[];t.noSelection=!0;t.createdNodes=[];t.zId=0;t._ver=(new Date).getTime()},l=function(n){var t=data.getCache(n);t||(t={},data.setCache(n,t));t.nodes=[];t.doms=[]},a=function(n){var t=n.treeObj,i=consts.event;t.bind(i.NODECREATED,function(t,i,r){tools.apply(n.callback.onNodeCreated,[t,i,r])});t.bind(i.CLICK,function(t,i,r,u,f){tools.apply(n.callback.onClick,[i,r,u,f])});t.bind(i.EXPAND,function(t,i,r){tools.apply(n.callback.onExpand,[t,i,r])});t.bind(i.COLLAPSE,function(t,i,r){tools.apply(n.callback.onCollapse,[t,i,r])});t.bind(i.ASYNC_SUCCESS,function(t,i,r,u){tools.apply(n.callback.onAsyncSuccess,[t,i,r,u])});t.bind(i.ASYNC_ERROR,function(t,i,r,u,f,e){tools.apply(n.callback.onAsyncError,[t,i,r,u,f,e])});t.bind(i.REMOVE,function(t,i,r){tools.apply(n.callback.onRemove,[t,i,r])});t.bind(i.SELECTED,function(t,i,r,u){tools.apply(n.callback.onSelected,[i,r,u])});t.bind(i.UNSELECTED,function(t,i,r,u){tools.apply(n.callback.onUnSelected,[i,r,u])})},v=function(n){var i=n.treeObj,t=consts.event;i.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)},y=function(n){var o=n.target,i=data.getSetting(n.data.treeId),r="",h=null,u="",e="",c=null,s=null,t=null;if(tools.eqs(n.type,"mousedown")?e="mousedown":tools.eqs(n.type,"mouseup")?e="mouseup":tools.eqs(n.type,"contextmenu")?e="contextmenu":tools.eqs(n.type,"click")?tools.eqs(o.tagName,"span")&&o.getAttribute("treeNode"+consts.id.SWITCH)!==null?(r=tools.getNodeMainDom(o).id,u="switchNode"):(t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id,u="clickNode")):tools.eqs(n.type,"dblclick")&&(e="dblclick",t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id,u="switchNode")),e.length>0&&r.length==0&&(t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id)),r.length>0){h=data.getNodeCache(i,r);switch(u){case"switchNode":h.isParent?tools.eqs(n.type,"click")||tools.eqs(n.type,"dblclick")&&tools.apply(i.view.dblClickExpand,[i.treeId,h],i.view.dblClickExpand)?c=f.onSwitchNode:u="":u="";break;case"clickNode":c=f.onClickNode}}switch(e){case"mousedown":s=f.onZTreeMousedown;break;case"mouseup":s=f.onZTreeMouseup;break;case"dblclick":s=f.onZTreeDblclick;break;case"contextmenu":s=f.onZTreeContextmenu}return{stop:!1,node:h,nodeEventType:u,nodeEventCallback:c,treeEventType:e,treeEventCallback:s}},p=function(n,t,i,r,u,f){if(i){var o=data.getRoot(n),e=n.data.key.children;i.level=t;i.tId=n.treeId+"_"+ ++o.zId;i.parentTId=r?r.tId:null;i.open=typeof i.open=="string"?tools.eqs(i.open,"true"):!!i.open;i[e]&&i[e].length>0?(i.isParent=!0,i.zAsync=!0):(i.isParent=typeof i.isParent=="string"?tools.eqs(i.isParent,"true"):!!i.isParent,i.open=i.isParent&&!n.async.enable?i.open:!1,i.zAsync=!i.isParent);i.isFirstNode=u;i.isLastNode=f;i.getParentNode=function(){return data.getNodeCache(n,i.parentTId)};i.getPreNode=function(){return data.getPreNode(n,i)};i.getNextNode=function(){return data.getNextNode(n,i)};i.isAjaxing=!1;data.fixPIdKeyValue(n,i)}},i={bind:[a],unbind:[v],caches:[l],nodes:[p],proxys:[y],roots:[c],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(n,t){data.getCache(n).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(n){return n.substring(n.lastIndexOf("_")+1)},addAfterA:function(n){i.afterA.push(n)},addBeforeA:function(n){i.beforeA.push(n)},addInnerAfterA:function(n){i.innerAfterA.push(n)},addInnerBeforeA:function(n){i.innerBeforeA.push(n)},addInitBind:function(n){i.bind.push(n)},addInitUnBind:function(n){i.unbind.push(n)},addInitCache:function(n){i.caches.push(n)},addInitNode:function(n){i.nodes.push(n)},addInitProxy:function(n,t){t?i.proxys.splice(0,0,n):i.proxys.push(n)},addInitRoot:function(n){i.roots.push(n)},addNodesData:function(n,t,i){var r=n.data.key.children;t[r]||(t[r]=[]);t[r].length>0&&(t[r][t[r].length-1].isLastNode=!1,view.setNodeLineIcos(n,t[r][t[r].length-1]));t.isParent=!0;t[r]=t[r].concat(i)},addSelectedNode:function(n,t){var i=data.getRoot(n);data.isSelectedNode(n,t)||i.curSelectedList.push(t)},addCreatedNode:function(n,t){if(!!n.callback.onNodeCreated||!!n.view.addDiyDom){var i=data.getRoot(n);i.createdNodes.push(t)}},addZTreeTools:function(n){i.zTreeTools.push(n)},exSetting:function(t){n.extend(!0,s,t)},fixPIdKeyValue:function(n,t){n.data.simpleData.enable&&(t[n.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[n.data.simpleData.idKey]:n.data.simpleData.rootPId)},getAfterA:function(){for(var n=0,t=i.afterA.length;n<t;n++)i.afterA[n].apply(this,arguments)},getBeforeA:function(){for(var n=0,t=i.beforeA.length;n<t;n++)i.beforeA[n].apply(this,arguments)},getInnerAfterA:function(){for(var n=0,t=i.innerAfterA.length;n<t;n++)i.innerAfterA[n].apply(this,arguments)},getInnerBeforeA:function(){for(var n=0,t=i.innerBeforeA.length;n<t;n++)i.innerBeforeA[n].apply(this,arguments)},getCache:function(n){return o[n.treeId]},getNextNode:function(n,t){var r,u,i,f;if(!t)return null;for(r=n.data.key.children,u=t.parentTId?t.getParentNode():data.getRoot(n),i=0,f=u[r].length-1;i<=f;i++)if(u[r][i]===t)return i==f?null:u[r][i+1];return null},getNodeByParam:function(n,t,i,r){var e,u,o,f;if(!t||!i)return null;for(e=n.data.key.children,u=0,o=t.length;u<o;u++){if(t[u][i]==r)return t[u];if(f=data.getNodeByParam(n,t[u][e],i,r),f)return f}return null},getNodeCache:function(n,t){if(!t)return null;var i=o[n.treeId].nodes[data.getNodeCacheId(t)];return i?i:null},getNodeName:function(n,t){var i=n.data.key.name;return""+t[i]},getNodeTitle:function(n,t){var i=n.data.key.title===""?n.data.key.name:n.data.key.title;return""+t[i]},getNodes:function(n){return data.getRoot(n)[n.data.key.children]},getNodesByParam:function(n,t,i,r){var e,f,u,o;if(!t||!i)return[];for(e=n.data.key.children,f=[],u=0,o=t.length;u<o;u++)t[u][i]==r&&f.push(t[u]),f=f.concat(data.getNodesByParam(n,t[u][e],i,r));return f},getNodesByParamFuzzy:function(n,t,i,r){var e,f,u,o;if(!t||!i)return[];for(e=n.data.key.children,f=[],r=r.toLowerCase(),u=0,o=t.length;u<o;u++)typeof t[u][i]=="string"&&t[u][i].toLowerCase().indexOf(r)>-1&&f.push(t[u]),f=f.concat(data.getNodesByParamFuzzy(n,t[u][e],i,r));return f},getNodesByFilter:function(n,t,i,r,u){var s,e,f,h,o;if(!t)return r?null:[];for(s=n.data.key.children,e=r?null:[],f=0,h=t.length;f<h;f++){if(tools.apply(i,[t[f],u],!1)){if(r)return t[f];e.push(t[f])}if(o=data.getNodesByFilter(n,t[f][s],i,r,u),r&&!!o)return o;e=r?o:e.concat(o)}return e},getPreNode:function(n,t){var r,u,i,f;if(!t)return null;for(r=n.data.key.children,u=t.parentTId?t.getParentNode():data.getRoot(n),i=0,f=u[r].length;i<f;i++)if(u[r][i]===t)return i==0?null:u[r][i-1];return null},getRoot:function(n){return n?e[n.treeId]:null},getRoots:function(){return e},getSetting:function(n){return u[n]},getSettings:function(){return u},getZTreeTools:function(n){var t=this.getRoot(this.getSetting(n));return t?t.treeTools:null},initCache:function(){for(var n=0,t=i.caches.length;n<t;n++)i.caches[n].apply(this,arguments)},initNode:function(){for(var n=0,t=i.nodes.length;n<t;n++)i.nodes[n].apply(this,arguments)},initRoot:function(){for(var n=0,t=i.roots.length;n<t;n++)i.roots[n].apply(this,arguments)},isSelectedNode:function(n,t){for(var r=data.getRoot(n),i=0,u=r.curSelectedList.length;i<u;i++)if(t===r.curSelectedList[i])return!0;return!1},removeNodeCache:function(n,t){var r=n.data.key.children,i,u;if(t[r])for(i=0,u=t[r].length;i<u;i++)arguments.callee(n,t[r][i]);data.getCache(n).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(n,t){for(var r=data.getRoot(n),i=0,u=r.curSelectedList.length;i<u;i++)t!==r.curSelectedList[i]&&data.getNodeCache(n,r.curSelectedList[i].tId)||(r.curSelectedList.splice(i,1),i--,u--)},setCache:function(n,t){o[n.treeId]=t},setRoot:function(n,t){e[n.treeId]=t},setZTreeTools:function(){for(var n=0,t=i.zTreeTools.length;n<t;n++)i.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(n,t){var u,i,r,f;if(!t)return[];if(u=n.data.key.children,i=[],tools.isArray(t))for(r=0,f=t.length;r<f;r++)i.push(t[r]),t[r][u]&&(i=i.concat(data.transformToArrayFormat(n,t[r][u])));else i.push(t),t[u]&&(i=i.concat(data.transformToArrayFormat(n,t[u])));return i},transformTozTreeFormat:function(n,t){var i,f,e=n.data.simpleData.idKey,u=n.data.simpleData.pIdKey,o=n.data.key.children,s,r;if(!e||e==""||!t)return[];if(tools.isArray(t)){for(s=[],r=[],i=0,f=t.length;i<f;i++)r[t[i][e]]=t[i];for(i=0,f=t.length;i<f;i++)r[t[i][u]]&&t[i][e]!=t[i][u]?(r[t[i][u]][o]||(r[t[i][u]][o]=[]),r[t[i][u]][o].push(t[i])):s.push(t[i]);return s}return[t]}},r={bindEvent:function(){for(var n=0,t=i.bind.length;n<t;n++)i.bind[n].apply(this,arguments)},unbindEvent:function(){for(var n=0,t=i.unbind.length;n<t;n++)i.unbind[n].apply(this,arguments)},bindTree:function(n){var i={treeId:n.treeId},t=n.treeObj;n.view.txtSelectedEnable||t.bind("selectstart",function(n){var t=n.originalEvent.srcElement.nodeName.toLowerCase();return t==="input"||t==="textarea"}).css({"-moz-user-select":"-moz-none"});t.bind("click",i,r.proxy);t.bind("dblclick",i,r.proxy);t.bind("mouseover",i,r.proxy);t.bind("mouseout",i,r.proxy);t.bind("mousedown",i,r.proxy);t.bind("mouseup",i,r.proxy);t.bind("contextmenu",i,r.proxy)},unbindTree:function(n){var t=n.treeObj;t.unbind("click",r.proxy).unbind("dblclick",r.proxy).unbind("mouseover",r.proxy).unbind("mouseout",r.proxy).unbind("mousedown",r.proxy).unbind("mouseup",r.proxy).unbind("contextmenu",r.proxy)},doProxy:function(){for(var t,r=[],n=0,u=i.proxys.length;n<u;n++)if(t=i.proxys[n].apply(this,arguments),r.push(t),t.stop)break;return r},proxy:function(n){var s=data.getSetting(n.data.treeId),u,o,t;if(!tools.uCanDo(s,n))return!0;var f=r.doProxy(n),i=!0,e=!1;for(u=0,o=f.length;u<o;u++)t=f[u],t.nodeEventCallback&&(e=!0,i=t.nodeEventCallback.apply(t,[n,t.node])&&i),t.treeEventCallback&&(e=!0,i=t.treeEventCallback.apply(t,[n,t.node])&&i);return i}},f={onSwitchNode:function(n,t){var i=data.getSetting(n.data.treeId);if(t.open){if(tools.apply(i.callback.beforeCollapse,[i.treeId,t],!0)==!1)return!0;data.getRoot(i).expandTriggerFlag=!0;view.switchNode(i,t)}else{if(tools.apply(i.callback.beforeExpand,[i.treeId,t],!0)==!1)return!0;data.getRoot(i).expandTriggerFlag=!0;view.switchNode(i,t)}return!0},onClickNode:function(n,t){var i=data.getSetting(n.data.treeId),r=i.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&data.isSelectedNode(i,t)?0:i.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&i.view.selectedMulti?2:1;return tools.apply(i.callback.beforeClick,[i.treeId,t,r],!0)==!1?!0:(r===0?view.cancelPreSelectedNode(i,t):view.selectNode(i,t,r===2),i.treeObj.trigger(consts.event.CLICK,[n,i.treeId,t,r]),!0)},onZTreeMousedown:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeMouseDown,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseDown,[n,i.treeId,t]),!0},onZTreeMouseup:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeMouseUp,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseUp,[n,i.treeId,t]),!0},onZTreeDblclick:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeDblClick,[i.treeId,t],!0)&&tools.apply(i.callback.onDblClick,[n,i.treeId,t]),!0},onZTreeContextmenu:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeRightClick,[i.treeId,t],!0)&&tools.apply(i.callback.onRightClick,[n,i.treeId,t]),typeof i.callback.onRightClick!="function"}},tools={apply:function(n,t,i){return typeof n=="function"?n.apply(h,t?t:[]):i},canAsync:function(n,t){var i=n.data.key.children;return n.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(n){var i,t;if(n===null)return null;i=tools.isArray(n)?[]:{};for(t in n)i[t]=n[t]instanceof Date?new Date(n[t].getTime()):typeof n[t]=="object"?arguments.callee(n[t]):n[t];return i},eqs:function(n,t){return n.toLowerCase()===t.toLowerCase()},isArray:function(n){return Object.prototype.toString.apply(n)==="[object Array]"},$:function(t,i,r){return!i||typeof i=="string"||(r=i,i=""),typeof t=="string"?n(t,r?r.treeObj.get(0).ownerDocument:null):n("#"+t.tId+i,r?r.treeObj:null)},getMDom:function(n,t,i){if(!t)return null;while(t&&t.id!==n.treeId){for(var r=0,u=i.length;t.tagName&&r<u;r++)if(tools.eqs(t.tagName,i[r].tagName)&&t.getAttribute(i[r].attrName)!==null)return t;t=t.parentNode}return null},getNodeMainDom:function(t){return n(t).parent("li").get(0)||n(t).parentsUntil("li").parent().get(0)},isChildOrSelf:function(t,i){return n(t).closest("#"+i).length>0},uCanDo:function(){return!0}},view={addNodes:function(n,i,r,u){if(!n.data.keep.leaf||!i||i.isParent)if(tools.isArray(r)||(r=[r]),n.data.simpleData.enable&&(r=data.transformTozTreeFormat(n,r)),i){var f=t(i,consts.id.SWITCH,n),e=t(i,consts.id.ICON,n),o=t(i,consts.id.UL,n);i.open||(view.replaceSwitchClass(i,f,consts.folder.CLOSE),view.replaceIcoClass(i,e,consts.folder.CLOSE),i.open=!1,o.css({display:"none"}));data.addNodesData(n,i,r);view.createNodes(n,i.level+1,r,i);u||view.expandCollapseParentNode(n,i,!0)}else data.addNodesData(n,data.getRoot(n),r),view.createNodes(n,0,r,null)},appendNodes:function(n,t,i,r,u,f){var o,h,s,l,e,c;if(!i)return[];for(o=[],h=n.data.key.children,s=0,l=i.length;s<l;s++){if(e=i[s],u){var a=r?r:data.getRoot(n),v=a[h],y=v.length==i.length&&s==0,p=s==i.length-1;data.initNode(n,t,e,r,y,p,f);data.addNodeCache(n,e)}c=[];e[h]&&e[h].length>0&&(c=view.appendNodes(n,t+1,e[h],e,u,f&&e.open));f&&(view.makeDOMNodeMainBefore(o,n,e),view.makeDOMNodeLine(o,n,e),data.getBeforeA(n,e,o),view.makeDOMNodeNameBefore(o,n,e),data.getInnerBeforeA(n,e,o),view.makeDOMNodeIcon(o,n,e),data.getInnerAfterA(n,e,o),view.makeDOMNodeNameAfter(o,n,e),data.getAfterA(n,e,o),e.isParent&&e.open&&view.makeUlHtml(n,e,o,c.join("")),view.makeDOMNodeMainAfter(o,n,e),data.addCreatedNode(n,e))}return o},appendParentULDom:function(n,i){var f=[],r=t(i,n),u,e,o;r.get(0)||!i.parentTId||(view.appendParentULDom(n,i.getParentNode()),r=t(i,n));u=t(i,consts.id.UL,n);u.get(0)&&u.remove();e=n.data.key.children;o=view.appendNodes(n,i.level+1,i[e],i,!1,!0);view.makeUlHtml(n,i,f,o.join(""));r.append(f.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,f,s,u,r,e,o,_tmpV;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0)==!1)return tools.apply(callback),!1;for(node&&(node.isAjaxing=!0,s=t(node,consts.id.ICON,setting),s.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})),u={},i=0,f=setting.async.autoParam.length;node&&i<f;i++)r=setting.async.autoParam[i].split("="),e=r,r.length>1&&(e=r[1],r=r[0]),u[e]=node[r];if(tools.isArray(setting.async.otherParam))for(i=0,f=setting.async.otherParam.length;i<f;i+=2)u[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(o in setting.async.otherParam)u[o]=setting.async.otherParam[o];return _tmpV=data.getRoot(setting)._ver,n.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:u,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&msg.length!=0?typeof msg=="string"?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0);view.setNodeLineIcos(setting,node);newNodes&&newNodes!==""?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,!newNodes?[]:tools.clone(newNodes),!!isSilent)):view.addNodes(setting,node,[],!!isSilent);setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]);tools.apply(callback)}},error:function(n,t,i){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,n,t,i]))}}),!0},cancelPreSelectedNode:function(n,i,u){for(var o=data.getRoot(n).curSelectedList,f,e=o.length-1;e>=0;e--)if(f=o[e],i===f||!i&&(!u||u!==f))if(t(f,consts.id.A,n).removeClass(consts.node.CURSELECTED),i){data.removeSelectedNode(n,i);n.treeObj.trigger(consts.event.UNSELECTED,[r,n.treeId,f]);break}else o.splice(e,1),n.treeObj.trigger(consts.event.UNSELECTED,[r,n.treeId,f])},createNodeCallback:function(n){var t,i;if(!!n.callback.onNodeCreated||!!n.view.addDiyDom)for(t=data.getRoot(n);t.createdNodes.length>0;)i=t.createdNodes.shift(),tools.apply(n.view.addDiyDom,[n.treeId,i]),!n.callback.onNodeCreated||n.treeObj.trigger(consts.event.NODECREATED,[n.treeId,i])},createNodes:function(n,i,r,u){var f,e;if(r&&r.length!=0){var o=data.getRoot(n),s=n.data.key.children,h=!u||u.open||!!t(u[s][0],n).get(0);o.createdNodes=[];f=view.appendNodes(n,i,r,u,!0,h);u?(e=t(u,consts.id.UL,n),e.get(0)&&e.append(f.join(""))):n.treeObj.append(f.join(""));view.createNodeCallback(n)}},destroy:function(n){n&&(data.initCache(n),data.initRoot(n),r.unbindTree(n),r.unbindEvent(n),n.treeObj.empty(),delete u[n.treeId])},expandCollapseNode:function(n,i,r,u,f){var c=data.getRoot(n),e=n.data.key.children,s;if(!i){tools.apply(f,[]);return}if(c.expandTriggerFlag&&(s=f,f=function(){s&&s();i.open?n.treeObj.trigger(consts.event.EXPAND,[n.treeId,i]):n.treeObj.trigger(consts.event.COLLAPSE,[n.treeId,i])},c.expandTriggerFlag=!1),!i.open&&i.isParent&&(!t(i,consts.id.UL,n).get(0)||i[e]&&i[e].length>0&&!t(i[e][0],n).get(0))&&(view.appendParentULDom(n,i),view.createNodeCallback(n)),i.open==r){tools.apply(f,[]);return}var o=t(i,consts.id.UL,n),l=t(i,consts.id.SWITCH,n),h=t(i,consts.id.ICON,n);i.isParent?(i.open=!i.open,i.iconOpen&&i.iconClose&&h.attr("style",view.makeNodeIcoStyle(n,i)),i.open?(view.replaceSwitchClass(i,l,consts.folder.OPEN),view.replaceIcoClass(i,h,consts.folder.OPEN),u==!1||n.view.expandSpeed==""?(o.show(),tools.apply(f,[])):i[e]&&i[e].length>0?o.slideDown(n.view.expandSpeed,f):(o.show(),tools.apply(f,[]))):(view.replaceSwitchClass(i,l,consts.folder.CLOSE),view.replaceIcoClass(i,h,consts.folder.CLOSE),u!=!1&&n.view.expandSpeed!=""&&i[e]&&i[e].length>0?o.slideUp(n.view.expandSpeed,f):(o.hide(),tools.apply(f,[])))):tools.apply(f,[])},expandCollapseParentNode:function(n,t,i,r,u){if(t){if(t.parentTId)view.expandCollapseNode(n,t,i,r);else{view.expandCollapseNode(n,t,i,r,u);return}t.parentTId&&view.expandCollapseParentNode(n,t.getParentNode(),i,r,u)}},expandCollapseSonNode:function(n,t,i,r,u){var h=data.getRoot(n),o=n.data.key.children,e=t?t[o]:h[o],c=t?!1:r,l=data.getRoot(n).expandTriggerFlag,f,s;if(data.getRoot(n).expandTriggerFlag=!1,e)for(f=0,s=e.length;f<s;f++)e[f]&&view.expandCollapseSonNode(n,e[f],i,c);data.getRoot(n).expandTriggerFlag=l;view.expandCollapseNode(n,t,i,r,u)},isSelectedNode:function(n,t){if(!t)return!1;for(var r=data.getRoot(n).curSelectedList,i=r.length-1;i>=0;i--)if(t===r[i])return!0;return!1},makeDOMNodeIcon:function(n,t,i){var r=data.getNodeName(t,i),u=t.view.nameIsHTML?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push("<span id='",i.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,i),"' style='",view.makeNodeIcoStyle(t,i),"'><\/span><span id='",i.tId,consts.id.SPAN,"'>",u,"<\/span>")},makeDOMNodeLine:function(n,t,i){n.push("<span id='",i.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,i),"' treeNode",consts.id.SWITCH,"><\/span>")},makeDOMNodeMainAfter:function(n){n.push("<\/li>")},makeDOMNodeMainBefore:function(n,t,i){n.push("<li id='",i.tId,"' class='",consts.className.LEVEL,i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(n){n.push("<\/a>")},makeDOMNodeNameBefore:function(n,t,i){var u=data.getNodeTitle(t,i),r=view.makeNodeUrl(t,i),f=view.makeNodeFontCss(t,i),e=[];for(var o in f)e.push(o,":",f[o],";");n.push("<a id='",i.tId,consts.id.A,"' class='",consts.className.LEVEL,i.level,"' treeNode",consts.id.A,' onclick="',i.click||"",'" ',r!=null&&r.length>0?"href='"+r+"'":""," target='",view.makeNodeTarget(i),"' style='",e.join(""),"'");tools.apply(t.view.showTitle,[t.treeId,i],t.view.showTitle)&&u&&n.push("title='",u.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");n.push(">")},makeNodeFontCss:function(n,t){var i=tools.apply(n.view.fontCss,[n.treeId,t],n.view.fontCss);return i&&typeof i!="function"?i:{}},makeNodeIcoClass:function(n,t){var i=["ico"];return t.isAjaxing||(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU)),consts.className.BUTTON+" "+i.join("_")},makeNodeIcoStyle:function(n,t){var i=[],r;return t.isAjaxing||(r=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon,r&&i.push("background:url(",r,") 0 0 no-repeat;"),n.view.showIcon!=!1&&tools.apply(n.view.showIcon,[n.treeId,t],!0)||i.push("width:0px;height:0px;")),i.join("")},makeNodeLineClass:function(n,t){var i=[];return n.view.showLine?t.level==0&&t.isFirstNode&&t.isLastNode?i.push(consts.line.ROOT):t.level==0&&t.isFirstNode?i.push(consts.line.ROOTS):t.isLastNode?i.push(consts.line.BOTTOM):i.push(consts.line.CENTER):i.push(consts.line.NOLINE),t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+i.join("_")},makeNodeLineClassEx:function(n){return consts.className.BUTTON+" "+consts.className.LEVEL+n.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(n){return n.target||"_blank"},makeNodeUrl:function(n,t){var i=n.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(n,t,i,r){i.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(n,t),"' style='display:",t.open?"block":"none","'>");i.push(r);i.push("<\/ul>")},makeUlLineClass:function(n,t){return n.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(n,i){var f,r,u,e,o,s;if(i&&(f=n.data.key.children,r=i[f],r)){for(u=0,e=r.length;u<e;u++)data.removeNodeCache(n,r[u]);data.removeSelectedNode(n);delete i[f];n.data.keep.parent?t(i,consts.id.UL,n).empty():(i.isParent=!1,i.open=!1,o=t(i,consts.id.SWITCH,n),s=t(i,consts.id.ICON,n),view.replaceSwitchClass(i,o,consts.folder.DOCU),view.replaceIcoClass(i,s,consts.folder.DOCU),t(i,consts.id.UL,n).remove())}},setFirstNode:function(n,t){var i=n.data.key.children,r=t[i].length;r>0&&(t[i][0].isFirstNode=!0)},setLastNode:function(n,t){var i=n.data.key.children,r=t[i].length;r>0&&(t[i][r-1].isLastNode=!0)},removeNode:function(n,i){var l=data.getRoot(n),u=n.data.key.children,r=i.parentTId?i.getParentNode():l,o,a,s,e,c,h,f,v;if(i.isFirstNode=!1,i.isLastNode=!1,i.getPreNode=function(){return null},i.getNextNode=function(){return null},data.getNodeCache(n,i.tId)){for(t(i,n).remove(),data.removeNodeCache(n,i),data.removeSelectedNode(n,i),o=0,a=r[u].length;o<a;o++)if(r[u][o].tId==i.tId){r[u].splice(o,1);break}view.setFirstNode(n,r);view.setLastNode(n,r);h=r[u].length;n.data.keep.parent||h!=0?n.view.showLine&&h>0&&(f=r[u][h-1],s=t(f,consts.id.UL,n),e=t(f,consts.id.SWITCH,n),c=t(f,consts.id.ICON,n),r==l?r[u].length==1?view.replaceSwitchClass(f,e,consts.line.ROOT):(v=t(r[u][0],consts.id.SWITCH,n),view.replaceSwitchClass(r[u][0],v,consts.line.ROOTS),view.replaceSwitchClass(f,e,consts.line.BOTTOM)):view.replaceSwitchClass(f,e,consts.line.BOTTOM),s.removeClass(consts.line.LINE)):(r.isParent=!1,r.open=!1,s=t(r,consts.id.UL,n),e=t(r,consts.id.SWITCH,n),c=t(r,consts.id.ICON,n),view.replaceSwitchClass(r,e,consts.folder.DOCU),view.replaceIcoClass(r,c,consts.folder.DOCU),s.css("display","none"))}},replaceIcoClass:function(n,t,i){var u,r;if(t&&!n.isAjaxing&&(u=t.attr("class"),u!=undefined)){r=u.split("_");switch(i){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[r.length-1]=i}t.attr("class",r.join("_"))}},replaceSwitchClass:function(n,t,i){var u,r;if(t&&(u=t.attr("class"),u!=undefined)){r=u.split("_");switch(i){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:r[0]=view.makeNodeLineClassEx(n)+i;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[1]=i}t.attr("class",r.join("_"));i!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}},selectNode:function(n,i,u){u||view.cancelPreSelectedNode(n,null,i);t(i,consts.id.A,n).addClass(consts.node.CURSELECTED);data.addSelectedNode(n,i);n.treeObj.trigger(consts.event.SELECTED,[r,n.treeId,i])},setNodeFontCss:function(n,i){var u=t(i,consts.id.A,n),r=view.makeNodeFontCss(n,i);r&&u.css(r)},setNodeLineIcos:function(n,i){if(i){var r=t(i,consts.id.SWITCH,n),f=t(i,consts.id.UL,n),u=t(i,consts.id.ICON,n),e=view.makeUlLineClass(n,i);e.length==0?f.removeClass(consts.line.LINE):f.addClass(e);r.attr("class",view.makeNodeLineClass(n,i));i.isParent?r.removeAttr("disabled"):r.attr("disabled","disabled");u.removeAttr("style");u.attr("style",view.makeNodeIcoStyle(n,i));u.attr("class",view.makeNodeIcoClass(n,i))}},setNodeName:function(n,i){var u=data.getNodeTitle(n,i),r=t(i,consts.id.SPAN,n),f;r.empty();n.view.nameIsHTML?r.html(data.getNodeName(n,i)):r.text(data.getNodeName(n,i));tools.apply(n.view.showTitle,[n.treeId,i],n.view.showTitle)&&(f=t(i,consts.id.A,n),f.attr("title",u?u:""))},setNodeTarget:function(n,i){var r=t(i,consts.id.A,n);r.attr("target",view.makeNodeTarget(i))},setNodeUrl:function(n,i){var u=t(i,consts.id.A,n),r=view.makeNodeUrl(n,i);r==null||r.length==0?u.removeAttr("href"):u.attr("href",r)},switchNode:function(n,t){if(t.open||!tools.canAsync(n,t))view.expandCollapseNode(n,t,!t.open);else if(n.async.enable){if(!view.asyncNode(n,t)){view.expandCollapseNode(n,t,!t.open);return}}else t&&view.expandCollapseNode(n,t,!t.open)}};n.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:tools,view:view,event:r,data:data},getZTreeObj:function(n){var t=data.getZTreeTools(n);return t?t:null},destroy:function(n){if(!!n&&n.length>0)view.destroy(data.getSetting(n));else for(var t in u)view.destroy(u[t])},init:function(i,f,e){var o=tools.clone(s),h,c,l;return n.extend(!0,o,f),o.treeId=i.attr("id"),o.treeObj=i,o.treeObj.empty(),u[o.treeId]=o,typeof document.body.style.maxHeight=="undefined"&&(o.view.expandSpeed=""),data.initRoot(o),h=data.getRoot(o),c=o.data.key.children,e=e?tools.clone(tools.isArray(e)?e:[e]):[],h[c]=o.data.simpleData.enable?data.transformTozTreeFormat(o,e):e,data.initCache(o),r.unbindTree(o),r.bindTree(o),r.unbindEvent(o),r.bindEvent(o),l={setting:o,addNodes:function(n,t,i){function u(){view.addNodes(o,n,r,i==!0)}if(!t||(n||(n=null),n&&!n.isParent&&o.data.keep.leaf))return null;var r=tools.clone(tools.isArray(t)?t:[t]);return tools.canAsync(o,n)?view.asyncNode(o,n,i,u):u(),r},cancelSelectedNode:function(n){view.cancelPreSelectedNode(o,n)},destroy:function(){view.destroy(o)},expandAll:function(n){return n=!!n,view.expandCollapseSonNode(o,null,n,!0),n},expandNode:function(n,i,r,u,f){if(!n||!n.isParent||(i!==!0&&i!==!1&&(i=!n.open),f=!!f,f&&i&&tools.apply(o.callback.beforeExpand,[o.treeId,n],!0)==!1)||f&&!i&&tools.apply(o.callback.beforeCollapse,[o.treeId,n],!0)==!1||(i&&n.parentTId&&view.expandCollapseParentNode(o,n.getParentNode(),i,!1),i===n.open&&!r))return null;if(data.getRoot(o).expandTriggerFlag=f,!tools.canAsync(o,n)&&r)view.expandCollapseSonNode(o,n,i,!0,function(){if(u!==!1)try{t(n,o).focus().blur()}catch(i){}});else if(n.open=!i,view.switchNode(this.setting,n),u!==!1)try{t(n,o).focus().blur()}catch(e){}return i},getNodes:function(){return data.getNodes(o)},getNodeByParam:function(n,t,i){return n?data.getNodeByParam(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodeByTId:function(n){return data.getNodeCache(o,n)},getNodesByParam:function(n,t,i){return n?data.getNodesByParam(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodesByParamFuzzy:function(n,t,i){return n?data.getNodesByParamFuzzy(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodesByFilter:function(n,t,i,r){return(t=!!t,!n||typeof n!="function")?t?null:[]:data.getNodesByFilter(o,i?i[o.data.key.children]:data.getNodes(o),n,t,r)},getNodeIndex:function(n){var i,r,t,u;if(!n)return null;for(i=o.data.key.children,r=n.parentTId?n.getParentNode():data.getRoot(o),t=0,u=r[i].length;t<u;t++)if(r[i][t]==n)return t;return-1},getSelectedNodes:function(){for(var t=[],i=data.getRoot(o).curSelectedList,n=0,r=i.length;n<r;n++)t.push(i[n]);return t},isSelectedNode:function(n){return data.isSelectedNode(o,n)},reAsyncChildNodes:function(n,i,r){var f,u,e,s,h;if(this.setting.async.enable){if(f=!n,f&&(n=data.getRoot(o)),i=="refresh"){for(u=this.setting.data.key.children,e=0,s=n[u]?n[u].length:0;e<s;e++)data.removeNodeCache(o,n[u][e]);data.removeSelectedNode(o);n[u]=[];f?this.setting.treeObj.empty():(h=t(n,consts.id.UL,o),h.empty())}view.asyncNode(this.setting,f?null:n,!!r)}},refresh:function(){this.setting.treeObj.empty();var n=data.getRoot(o),t=n[o.data.key.children];data.initRoot(o);n[o.data.key.children]=t;data.initCache(o);view.createNodes(o,0,n[o.data.key.children])},removeChildNodes:function(n){if(!n)return null;var i=o.data.key.children,t=n[i];return view.removeChildNodes(o,n),t?t:null},removeNode:function(n,t){n&&((t=!!t,t&&tools.apply(o.callback.beforeRemove,[o.treeId,n],!0)==!1)||(view.removeNode(o,n),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[o.treeId,n])))},selectNode:function(n,i){if(n&&tools.uCanDo(o)){if(i=o.view.selectedMulti&&i,n.parentTId)view.expandCollapseParentNode(o,n.getParentNode(),!0,!1,function(){try{t(n,o).focus().blur()}catch(i){}});else try{t(n,o).focus().blur()}catch(r){}view.selectNode(o,n,i)}},transformTozTreeNodes:function(n){return data.transformTozTreeFormat(o,n)},transformToArray:function(n){return data.transformToArrayFormat(o,n)},updateNode:function(n){if(n){var i=t(n,o);i.get(0)&&tools.uCanDo(o)&&(view.setNodeName(o,n),view.setNodeTarget(o,n),view.setNodeUrl(o,n),view.setNodeLineIcos(o,n),view.setNodeFontCss(o,n))}}},h.treeTools=l,data.setZTreeTools(o,l),h[c]&&h[c].length>0?view.createNodes(o,0,h[c]):o.async.enable&&o.async.url&&o.async.url!==""&&view.asyncNode(o),l}};var h=n.fn.zTree,t=tools.$,consts=h.consts})(jQuery);
//# sourceMappingURL=jquery.ztree.core-3.5.min.js.map
