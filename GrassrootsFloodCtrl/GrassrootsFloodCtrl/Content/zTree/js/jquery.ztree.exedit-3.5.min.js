(function(n){var e={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},p=function(n){var t=u.getRoot(n),i=u.getRoots();t.curEditNode=null;t.curEditInput=null;t.curHoverNode=null;t.dragFlag=0;t.dragNodeShowBefore=[];t.dragMaskList=[];i.showHoverDom=!0},w=function(){},b=function(n){var i=n.treeObj,u=t.event;i.bind(u.RENAME,function(t,i,u,f){r.apply(n.callback.onRename,[t,i,u,f])});i.bind(u.DRAG,function(t,i,u,f){r.apply(n.callback.onDrag,[i,u,f])});i.bind(u.DRAGMOVE,function(t,i,u,f){r.apply(n.callback.onDragMove,[i,u,f])});i.bind(u.DROP,function(t,i,u,f,e,o,s){r.apply(n.callback.onDrop,[i,u,f,e,o,s])})},k=function(n){var i=n.treeObj,r=t.event;i.unbind(r.RENAME);i.unbind(r.DRAG);i.unbind(r.DRAGMOVE);i.unbind(r.DROP)},d=function(n){var c=n.target,o=u.getSetting(n.data.treeId),a=n.relatedTarget,f="",l=null,e="",h=null,i=null;if(r.eqs(n.type,"mouseover")?(i=r.getMDom(o,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=r.getNodeMainDom(i).id,e="hoverOverNode")):r.eqs(n.type,"mouseout")?(i=r.getMDom(o,a,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i||(f="remove",e="hoverOutNode")):r.eqs(n.type,"mousedown")&&(i=r.getMDom(o,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=r.getNodeMainDom(i).id,e="mousedownNode")),f.length>0){l=u.getNodeCache(o,f);switch(e){case"mousedownNode":h=s.onMousedownNode;break;case"hoverOverNode":h=s.onHoverOverNode;break;case"hoverOutNode":h=s.onHoverOutNode}}return{stop:!1,node:l,nodeEventType:e,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}},g=function(n,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)},nt=function(n,e){e.cancelEditName=function(n){var t=u.getRoot(this.setting);t.curEditNode&&i.cancelCurEditNode(this.setting,n?n:null,!0)};e.copyNode=function(n,u,f,e){if(!u||n&&!n.isParent&&this.setting.data.keep.leaf&&f===t.move.TYPE_INNER)return null;var h=this,o=r.clone(u);if(n||(n=null,f=t.move.TYPE_INNER),f==t.move.TYPE_INNER){function s(){i.addNodes(h.setting,n,[o],e)}r.canAsync(this.setting,n)?i.asyncNode(this.setting,n,e,s):s()}else i.addNodes(this.setting,n.parentNode,[o],e),i.moveNode(this.setting,n,o,f,!1,e);return o};e.editName=function(n){n&&n.tId&&n===u.getNodeCache(this.setting,n.tId)&&(n.parentTId&&i.expandCollapseParentNode(this.setting,n.getParentNode(),!0),i.editNode(this.setting,n))};e.moveNode=function(n,u,e,o){function s(){i.moveNode(h.setting,n,u,e,!1,o)}if(!u)return u;if(n&&!n.isParent&&this.setting.data.keep.leaf&&e===t.move.TYPE_INNER||n&&(u.parentTId==n.tId&&e==t.move.TYPE_INNER||f(u,this.setting).find("#"+n.tId).length>0))return null;n||(n=null);var h=this;return r.canAsync(this.setting,n)&&e===t.move.TYPE_INNER?i.asyncNode(this.setting,n,o,s):s(),u};e.setEditable=function(n){return this.setting.edit.enable=n,this.refresh()}},tt={setSonNodeLevel:function(n,t,i){var r,f,e;if(i&&(r=n.data.key.children,i.level=t?t.level+1:0,i[r]))for(f=0,e=i[r].length;f<e;f++)i[r][f]&&u.setSonNodeLevel(n,i,i[r][f])}},s={onHoverOverNode:function(n,t){var r=u.getSetting(n.data.treeId),f=u.getRoot(r);if(f.curHoverNode!=t)s.onHoverOutNode(n);f.curHoverNode=t;i.addHoverDom(r,t)},onHoverOutNode:function(n){var r=u.getSetting(n.data.treeId),t=u.getRoot(r);t.curHoverNode&&!u.isSelectedNode(r,t.curHoverNode)&&(i.removeTreeDom(r,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(o,s){function at(o){var s,ht,d,at,dt,ki,gt,ni,ti,hi,ct,vt,ot,ui,wt,bt,bi;if(w.dragFlag==0&&Math.abs(yt-o.clientX)<c.edit.drag.minMoveSize&&Math.abs(pt-o.clientY)<c.edit.drag.minMoveSize)return!0;if(ki=c.data.key.children,tt.css("cursor","pointer"),w.dragFlag==0){if(r.apply(c.callback.beforeDrag,[c.treeId,l],!0)==!1)return et(o),!0;for(s=0,ht=l.length;s<ht;s++)s==0&&(w.dragNodeShowBefore=[]),d=l[s],d.isParent&&d.open?(i.expandCollapseNode(c,d,!d.open),w.dragNodeShowBefore[d.tId]=!0):w.dragNodeShowBefore[d.tId]=!1;if(w.dragFlag=1,st.showHoverDom=!1,r.showIfameMask(c,!0),gt=!0,ni=-1,l.length>1)for(ti=l[0].parentTId?l[0].getParentNode()[ki]:u.getNodes(c),dt=[],s=0,ht=ti.length;s<ht;s++)if(w.dragNodeShowBefore[ti[s].tId]!==undefined&&(gt&&ni>-1&&ni+1!==s&&(gt=!1),dt.push(ti[s]),ni=s),l.length===dt.length){l=dt;break}for(gt&&(it=l[0].getPreNode(),rt=l[l.length-1].getNextNode()),k=f("<ul class='zTreeDragUL'><\/ul>",c),s=0,ht=l.length;s<ht;s++)(d=l[s],d.editNameFlag=!1,i.selectNode(c,d,s>0),i.removeTreeDom(c,d),s>c.edit.drag.maxShowNodeNum-1)||(at=f("<li id='"+d.tId+"_tmp'><\/li>",c),at.append(f(d,t.id.A,c).clone()),at.css("padding","0"),at.children("#"+d.tId+t.id.A).removeClass(t.node.CURSELECTED),k.append(at),s==c.edit.drag.maxShowNodeNum-1&&(at=f("<li id='"+d.tId+"_moretmp'><a>  ...  <\/a><\/li>",c),k.append(at)));k.attr("id",l[0].tId+t.id.UL+"_tmp");k.addClass(c.treeObj.attr("class"));k.appendTo(tt);p=f("<span class='tmpzTreeMove_arrow'><\/span>",c);p.attr("id","zTreeMove_arrow_tmp");p.appendTo(tt);c.treeObj.trigger(t.event.DRAG,[o,c.treeId,l])}if(w.dragFlag==1){a&&p.attr("id")==o.target.id&&v&&o.clientX+b.scrollLeft()+2>n("#"+v+t.id.A,a).offset().left?(hi=n("#"+v+t.id.A,a),o.target=hi.length>0?hi.get(0):o.target):a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER));a=null;v=null;g=!1;h=c;ct=u.getSettings();for(vt in ct)ct[vt].treeId&&ct[vt].edit.enable&&ct[vt].treeId!=c.treeId&&(o.target.id==ct[vt].treeId||n(o.target).parents("#"+ct[vt].treeId).length>0)&&(g=!0,h=ct[vt]);var ii=b.scrollTop(),ci=b.scrollLeft(),ri=h.treeObj.offset(),fr=h.treeObj.get(0).scrollHeight,er=h.treeObj.get(0).scrollWidth,li=o.clientY+ii-ri.top,ai=h.treeObj.height()+ri.top-o.clientY-ii,vi=o.clientX+ci-ri.left,yi=h.treeObj.width()+ri.left-o.clientX-ci,di=li<c.edit.drag.borderMax&&li>c.edit.drag.borderMin,gi=ai<c.edit.drag.borderMax&&ai>c.edit.drag.borderMin,nr=vi<c.edit.drag.borderMax&&vi>c.edit.drag.borderMin,tr=yi<c.edit.drag.borderMax&&yi>c.edit.drag.borderMin,or=li>c.edit.drag.borderMin&&ai>c.edit.drag.borderMin&&vi>c.edit.drag.borderMin&&yi>c.edit.drag.borderMin,sr=di&&h.treeObj.scrollTop()<=0,hr=gi&&h.treeObj.scrollTop()+h.treeObj.height()+10>=fr,cr=nr&&h.treeObj.scrollLeft()<=0,lr=tr&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=er;if(o.target&&r.isChildOrSelf(o.target,h.treeId)){for(ot=o.target;ot&&ot.tagName&&!r.eqs(ot.tagName,"li")&&ot.id!=h.treeId;)ot=ot.parentNode;for(ui=!0,s=0,ht=l.length;s<ht;s++)if(d=l[s],ot.id===d.tId){ui=!1;break}else if(f(d,c).find("#"+ot.id).length>0){ui=!1;break}ui&&o.target&&r.isChildOrSelf(o.target,ot.id+t.id.A)&&(a=n(ot),v=ot.id)}if(d=l[0],or&&r.isChildOrSelf(o.target,h.treeId)&&(!a&&(o.target.id==h.treeId||sr||hr||cr||lr)&&(g||!g&&d.parentTId)&&(a=h.treeObj),di?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):gi&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10),nr?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):tr&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10),a&&a!=h.treeObj&&a.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+a.offset().left-h.treeObj.offset().left)),k.css({top:o.clientY+ii+3+"px",left:o.clientX+ci+3+"px"}),wt=0,bt=0,a&&a.attr("id")!=h.treeId){var nt=v==null?null:u.getNodeCache(h,v),pi=(o.ctrlKey||o.metaKey)&&c.edit.drag.isMove&&c.edit.drag.isCopy||!c.edit.drag.isMove&&c.edit.drag.isCopy,ar=!!(it&&v===it.tId),vr=!!(rt&&v===rt.tId),yr=d.parentTId&&d.parentTId==v,fi=(pi||!vr)&&r.apply(h.edit.drag.prev,[h.treeId,l,nt],!!h.edit.drag.prev),ei=(pi||!ar)&&r.apply(h.edit.drag.next,[h.treeId,l,nt],!!h.edit.drag.next),wi=(pi||!yr)&&!(h.data.keep.leaf&&!nt.isParent)&&r.apply(h.edit.drag.inner,[h.treeId,l,nt],!!h.edit.drag.inner);if(fi||ei||wi){var kt=n("#"+v+t.id.A,a),ir=nt.isLastNode?null:n("#"+nt.getNextNode().tId+t.id.A,a.next()),oi=kt.offset().top,pr=kt.offset().left,rr=fi?wi?.25:ei?.5:1:-1,ur=ei?wi?.75:fi?.5:0:-1,si=(o.clientY+ii-oi)/kt.height();(rr==1||si<=rr&&si>=-.2)&&fi?(wt=1-p.width(),bt=oi-p.height()/2,y=t.move.TYPE_PREV):(ur==0||si>=ur&&si<=1.2)&&ei?(wt=1-p.width(),bt=ir==null||nt.isParent&&nt.open?oi+kt.height()-p.height()/2:ir.offset().top-p.height()/2,y=t.move.TYPE_NEXT):(wt=5-p.width(),bt=oi,y=t.move.TYPE_INNER);p.css({display:"block",top:bt+"px",left:pr+wt+"px"});kt.addClass(t.node.TMPTARGET_NODE+"_"+y);(ut!=v||ft!=y)&&(lt=(new Date).getTime());nt&&nt.isParent&&y==t.move.TYPE_INNER&&(bi=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==nt.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===nt.tId&&(bi=!1),bi&&(window.zTreeMoveTimer=setTimeout(function(){y==t.move.TYPE_INNER&&nt&&nt.isParent&&!nt.open&&(new Date).getTime()-lt>h.edit.drag.autoOpenTime&&r.apply(h.callback.beforeDragOpen,[h.treeId,nt],!0)&&(i.switchNode(h,nt),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(t.event.EXPAND,[h.treeId,nt]))},h.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=nt.tId))}else a=null,v="",y=t.move.TYPE_INNER,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else y=t.move.TYPE_INNER,a&&r.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?a.addClass(t.node.TMPTARGET_TREE):a=null,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);ut=v;ft=y;c.treeObj.trigger(t.event.DRAGMOVE,[o,c.treeId,l])}return!1}function et(o){var rt,ot,it,nt,d,s;if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),ut=null,ft=null,b.unbind("mousemove",at),b.unbind("mouseup",et),b.unbind("selectstart",vt),tt.css("cursor","auto"),a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER)),r.showIfameMask(c,!1),st.showHoverDom=!0,w.dragFlag!=0){for(w.dragFlag=0,rt=0,ot=l.length;rt<ot;rt++)it=l[rt],it.isParent&&w.dragNodeShowBefore[it.tId]&&!it.open&&(i.expandCollapseNode(c,it,!it.open),delete w.dragNodeShowBefore[it.tId]);if(k&&k.remove(),p&&p.remove(),nt=(o.ctrlKey||o.metaKey)&&c.edit.drag.isMove&&c.edit.drag.isCopy||!c.edit.drag.isMove&&c.edit.drag.isCopy,!nt&&a&&v&&l[0].parentTId&&v==l[0].parentTId&&y==t.move.TYPE_INNER&&(a=null),a){if(d=v==null?null:u.getNodeCache(h,v),r.apply(c.callback.beforeDrop,[h.treeId,l,d,y,nt],!0)==!1){i.selectNodes(ct,l);return}s=nt?r.clone(l):l;function ht(){if(g){if(!nt)for(var n=0,r=l.length;n<r;n++)i.removeNode(c,l[n]);if(y==t.move.TYPE_INNER)i.addNodes(h,d,s);else if(i.addNodes(h,d.getParentNode(),s),y==t.move.TYPE_PREV)for(n=0,r=s.length;n<r;n++)i.moveNode(h,d,s[n],y,!1);else for(n=-1,r=s.length-1;n<r;r--)i.moveNode(h,d,s[r],y,!1)}else if(nt&&y==t.move.TYPE_INNER)i.addNodes(h,d,s);else if(nt&&i.addNodes(h,d.getParentNode(),s),y!=t.move.TYPE_NEXT)for(n=0,r=s.length;n<r;n++)i.moveNode(h,d,s[n],y,!1);else for(n=-1,r=s.length-1;n<r;r--)i.moveNode(h,d,s[r],y,!1);i.selectNodes(h,s);f(s[0],c).focus().blur();c.treeObj.trigger(t.event.DROP,[o,h.treeId,s,d,y,nt])}y==t.move.TYPE_INNER&&r.canAsync(h,d)?i.asyncNode(h,d,!1,ht):ht()}else i.selectNodes(ct,l),c.treeObj.trigger(t.event.DROP,[o,c.treeId,l,null,null,null])}}function vt(){return!1}var d,ot,c=u.getSetting(o.data.treeId),w=u.getRoot(c),st=u.getRoots();if(o.button==2||!c.edit.enable||!c.edit.drag.isCopy&&!c.edit.drag.isMove)return!0;var ht=o.target,nt=u.getRoot(c).curSelectedList,l=[];if(u.isSelectedNode(c,s))for(d=0,ot=nt.length;d<ot;d++){if(nt[d].editNameFlag&&r.eqs(ht.tagName,"input")&&ht.getAttribute("treeNode"+t.id.INPUT)!==null)return!0;if(l.push(nt[d]),l[0].parentTId!==nt[d].parentTId){l=[s];break}}else l=[s];i.editNodeBlur=!0;i.cancelCurEditNode(c);var b=n(c.treeObj.get(0).ownerDocument),tt=n(c.treeObj.get(0).ownerDocument.body),k,p,a,g=!1,h=c,ct=c,it,rt,ut=null,ft=null,v=null,y=t.move.TYPE_INNER,yt=o.clientX,pt=o.clientY,lt=(new Date).getTime();return r.uCanDo(c)&&b.bind("mousemove",at),b.bind("mouseup",et),b.bind("selectstart",vt),o.preventDefault&&o.preventDefault(),!0}},it={getAbs:function(n){var t=n.getBoundingClientRect(),i=document.body.scrollTop+document.documentElement.scrollTop,r=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+r,t.top+i]},inputFocus:function(n){n.get(0)&&(n.focus(),r.setCursorPosition(n.get(0),n.val().length))},inputSelect:function(n){n.get(0)&&(n.focus(),n.select())},setCursorPosition:function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},showIfameMask:function(n,t){for(var e=u.getRoot(n),o,i,h;e.dragMaskList.length>0;)e.dragMaskList[0].remove(),e.dragMaskList.shift();if(t)for(o=f("iframe",n),i=0,h=o.length;i<h;i++){var s=o.get(i),c=r.getAbs(s),l=f("<div id='zTreeMask_"+i+"' class='zTreeMask' style='top:"+c[1]+"px; left:"+c[0]+"px; width:"+s.offsetWidth+"px; height:"+s.offsetHeight+"px;'><\/div>",n);l.appendTo(f("body",n));e.dragMaskList.push(l)}}},rt={addEditBtn:function(n,u){if(!u.editNameFlag&&!(f(u,t.id.EDIT,n).length>0)&&r.apply(n.edit.showRenameBtn,[n.treeId,u],n.edit.showRenameBtn)){var e=f(u,t.id.A,n),o="<span class='"+t.className.BUTTON+" edit' id='"+u.tId+t.id.EDIT+"' title='"+r.apply(n.edit.renameTitle,[n.treeId,u],n.edit.renameTitle)+"' treeNode"+t.id.EDIT+" style='display:none;'><\/span>";e.append(o);f(u,t.id.EDIT,n).bind("click",function(){return!r.uCanDo(n)||r.apply(n.callback.beforeEditName,[n.treeId,u],!0)==!1?!1:(i.editNode(n,u),!1)}).show()}},addRemoveBtn:function(n,u){if(!u.editNameFlag&&!(f(u,t.id.REMOVE,n).length>0)&&r.apply(n.edit.showRemoveBtn,[n.treeId,u],n.edit.showRemoveBtn)){var e=f(u,t.id.A,n),o="<span class='"+t.className.BUTTON+" remove' id='"+u.tId+t.id.REMOVE+"' title='"+r.apply(n.edit.removeTitle,[n.treeId,u],n.edit.removeTitle)+"' treeNode"+t.id.REMOVE+" style='display:none;'><\/span>";e.append(o);f(u,t.id.REMOVE,n).bind("click",function(){return!r.uCanDo(n)||r.apply(n.callback.beforeRemove,[n.treeId,u],!0)==!1?!1:(i.removeNode(n,u),n.treeObj.trigger(t.event.REMOVE,[n.treeId,u]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(n,t){u.getRoots().showHoverDom&&(t.isHover=!0,n.edit.enable&&(i.addEditBtn(n,t),i.addRemoveBtn(n,t)),r.apply(n.view.addHoverDom,[n.treeId,t]))},cancelCurEditNode:function(n,e,o){var h=u.getRoot(n),a=n.data.key.name,s=h.curEditNode,c,l,v;if(s){if(c=h.curEditInput,l=e?e:o?s[a]:c.val(),r.apply(n.callback.beforeRename,[n.treeId,s,l,o],!0)===!1)return!1;s[a]=l;v=f(s,t.id.A,n);v.removeClass(t.node.CURSELECTED_EDIT);c.unbind();i.setNodeName(n,s);s.editNameFlag=!1;h.curEditNode=null;h.curEditInput=null;i.selectNode(n,s,!1);n.treeObj.trigger(t.event.RENAME,[n.treeId,s,o])}return h.noSelection=!0,!0},editNode:function(n,e){var s=u.getRoot(n),h,o;if(i.editNodeBlur=!1,u.isSelectedNode(n,e)&&s.curEditNode==e&&e.editNameFlag){setTimeout(function(){r.inputFocus(s.curEditInput)},0);return}h=n.data.key.name;e.editNameFlag=!0;i.removeTreeDom(n,e);i.cancelCurEditNode(n);i.selectNode(n,e,!1);f(e,t.id.SPAN,n).html("<input type=text class='rename' id='"+e.tId+t.id.INPUT+"' treeNode"+t.id.INPUT+" >");o=f(e,t.id.INPUT,n);o.attr("value",e[h]);n.edit.editNameSelectAll?r.inputSelect(o):r.inputFocus(o);o.bind("blur",function(){i.editNodeBlur||i.cancelCurEditNode(n)}).bind("keydown",function(t){t.keyCode=="13"?(i.editNodeBlur=!0,i.cancelCurEditNode(n)):t.keyCode=="27"&&i.cancelCurEditNode(n,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1});f(e,t.id.A,n).addClass(t.node.CURSELECTED_EDIT);s.curEditInput=o;s.noSelection=!1;s.curEditNode=e},moveNode:function(n,r,e,o,s,h){var tt=u.getRoot(n),c=n.data.key.children,l,g,p,a,b,rt,w;if(r!=e&&(!n.data.keep.leaf||!r||r.isParent||o!=t.move.TYPE_INNER)){l=e.parentTId?e.getParentNode():tt;g=r===null||r==tt;g&&r===null&&(r=tt);g&&(o=t.move.TYPE_INNER);p=r.parentTId?r.getParentNode():tt;o!=t.move.TYPE_PREV&&o!=t.move.TYPE_NEXT&&(o=t.move.TYPE_INNER);o==t.move.TYPE_INNER&&(g?e.parentTId=null:(r.isParent||(r.isParent=!0,r.open=!!r.open,i.setNodeLineIcos(n,r)),e.parentTId=r.tId));g?(a=n.treeObj,b=a):(h||o!=t.move.TYPE_INNER?h||i.expandCollapseNode(n,r.getParentNode(),!0,!1):i.expandCollapseNode(n,r,!0,!1),a=f(r,n),b=f(r,t.id.UL,n),!a.get(0)||b.get(0)||(rt=[],i.makeUlHtml(n,r,rt,""),a.append(rt.join(""))),b=f(r,t.id.UL,n));w=f(e,n);w.get(0)?a.get(0)||w.remove():w=i.appendNodes(n,e.level,[e],null,!1,!0).join("");b.get(0)&&o==t.move.TYPE_INNER?b.append(w):a.get(0)&&o==t.move.TYPE_PREV?a.before(w):a.get(0)&&o==t.move.TYPE_NEXT&&a.after(w);var v,it,k=-1,nt=0,d=null,y=null,ut=e.level;if(e.isFirstNode)k=0,l[c].length>1&&(d=l[c][1],d.isFirstNode=!0);else if(e.isLastNode)k=l[c].length-1,d=l[c][k-1],d.isLastNode=!0;else for(v=0,it=l[c].length;v<it;v++)if(l[c][v].tId==e.tId){k=v;break}if(k>=0&&l[c].splice(k,1),o!=t.move.TYPE_INNER)for(v=0,it=p[c].length;v<it;v++)p[c][v].tId==r.tId&&(nt=v);if(o==t.move.TYPE_INNER?(r[c]||(r[c]=[]),r[c].length>0&&(y=r[c][r[c].length-1],y.isLastNode=!1),r[c].splice(r[c].length,0,e),e.isLastNode=!0,e.isFirstNode=r[c].length==1):r.isFirstNode&&o==t.move.TYPE_PREV?(p[c].splice(nt,0,e),y=r,y.isFirstNode=!1,e.parentTId=r.parentTId,e.isFirstNode=!0,e.isLastNode=!1):r.isLastNode&&o==t.move.TYPE_NEXT?(p[c].splice(nt+1,0,e),y=r,y.isLastNode=!1,e.parentTId=r.parentTId,e.isFirstNode=!1,e.isLastNode=!0):(o==t.move.TYPE_PREV?p[c].splice(nt,0,e):p[c].splice(nt+1,0,e),e.parentTId=r.parentTId,e.isFirstNode=!1,e.isLastNode=!1),u.fixPIdKeyValue(n,e),u.setSonNodeLevel(n,e.getParentNode(),e),i.setNodeLineIcos(n,e),i.repairNodeLevelClass(n,e,ut),!n.data.keep.parent&&l[c].length<1){l.isParent=!1;l.open=!1;var ft=f(l,t.id.UL,n),et=f(l,t.id.SWITCH,n),ot=f(l,t.id.ICON,n);i.replaceSwitchClass(l,et,t.folder.DOCU);i.replaceIcoClass(l,ot,t.folder.DOCU);ft.css("display","none")}else d&&i.setNodeLineIcos(n,d);y&&i.setNodeLineIcos(n,y);!!n.check&&n.check.enable&&i.repairChkClass&&(i.repairChkClass(n,l),i.repairParentChkClassWithSelf(n,l),l!=e.parent&&i.repairParentChkClassWithSelf(n,e));h||i.expandCollapseParentNode(n,e.getParentNode(),!0,s)}},removeEditBtn:function(n,i){f(i,t.id.EDIT,n).unbind().remove()},removeRemoveBtn:function(n,i){f(i,t.id.REMOVE,n).unbind().remove()},removeTreeDom:function(n,t){t.isHover=!1;i.removeEditBtn(n,t);i.removeRemoveBtn(n,t);r.apply(n.view.removeHoverDom,[n.treeId,t])},repairNodeLevelClass:function(n,i,r){if(r!==i.level){var o=f(i,n),s=f(i,t.id.A,n),h=f(i,t.id.UL,n),u=t.className.LEVEL+r,e=t.className.LEVEL+i.level;o.removeClass(u);o.addClass(e);s.removeClass(u);s.addClass(e);h.removeClass(u);h.addClass(e)}},selectNodes:function(n,t){for(var r=0,u=t.length;r<u;r++)i.selectNode(n,t[r],r>0)}},ut={tools:it,view:rt,event:{},data:tt},h,c,y,l,a,v;n.extend(!0,n.fn.zTree.consts,e);n.extend(!0,n.fn.zTree._z,ut);var o=n.fn.zTree,r=o._z.tools,t=o.consts,i=o._z.view,u=o._z.data,ft=o._z.event,f=r.$;u.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});u.addInitBind(b);u.addInitUnBind(k);u.addInitCache(w);u.addInitNode(g);u.addInitProxy(d);u.addInitRoot(p);u.addZTreeTools(nt);h=i.cancelPreSelectedNode;i.cancelPreSelectedNode=function(n,t){for(var f=u.getRoot(n).curSelectedList,r=0,e=f.length;r<e;r++)if((!t||t===f[r])&&(i.removeTreeDom(n,f[r]),t))break;h&&h.apply(i,arguments)};c=i.createNodes;i.createNodes=function(n,t,r,u){(c&&c.apply(i,arguments),r)&&i.repairParentChkClassWithSelf&&i.repairParentChkClassWithSelf(n,u)};y=i.makeNodeUrl;i.makeNodeUrl=function(n){return n.edit.enable?null:y.apply(i,arguments)};l=i.removeNode;i.removeNode=function(n,t){var r=u.getRoot(n);r.curEditNode===t&&(r.curEditNode=null);l&&l.apply(i,arguments)};a=i.selectNode;i.selectNode=function(n,t){var r=u.getRoot(n);return u.isSelectedNode(n,t)&&r.curEditNode==t&&t.editNameFlag?!1:(a&&a.apply(i,arguments),i.addHoverDom(n,t),!0)};v=r.uCanDo;r.uCanDo=function(n,t){var f=u.getRoot(n);return t&&(r.eqs(t.type,"mouseover")||r.eqs(t.type,"mouseout")||r.eqs(t.type,"mousedown")||r.eqs(t.type,"mouseup"))?!0:(f.curEditNode&&(i.editNodeBlur=!1,f.curEditInput.focus()),!f.curEditNode&&(v?v.apply(i,arguments):!0))}})(jQuery);
//# sourceMappingURL=jquery.ztree.exedit-3.5.min.js.map
