(function(n){var u={},e={},o={},s={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},c=function(n){var t=data.getRoot(n);t||(t={},data.setRoot(n,t));t[n.data.key.children]=[];t.expandTriggerFlag=!1;t.curSelectedList=[];t.noSelection=!0;t.createdNodes=[];t.zId=0;t._ver=(new Date).getTime()},l=function(n){var t=data.getCache(n);t||(t={},data.setCache(n,t));t.nodes=[];t.doms=[]},a=function(n){var t=n.treeObj,i=consts.event;t.bind(i.NODECREATED,function(t,i,r){tools.apply(n.callback.onNodeCreated,[t,i,r])});t.bind(i.CLICK,function(t,i,r,u,f){tools.apply(n.callback.onClick,[i,r,u,f])});t.bind(i.EXPAND,function(t,i,r){tools.apply(n.callback.onExpand,[t,i,r])});t.bind(i.COLLAPSE,function(t,i,r){tools.apply(n.callback.onCollapse,[t,i,r])});t.bind(i.ASYNC_SUCCESS,function(t,i,r,u){tools.apply(n.callback.onAsyncSuccess,[t,i,r,u])});t.bind(i.ASYNC_ERROR,function(t,i,r,u,f,e){tools.apply(n.callback.onAsyncError,[t,i,r,u,f,e])});t.bind(i.REMOVE,function(t,i,r){tools.apply(n.callback.onRemove,[t,i,r])});t.bind(i.SELECTED,function(t,i,r,u){tools.apply(n.callback.onSelected,[i,r,u])});t.bind(i.UNSELECTED,function(t,i,r,u){tools.apply(n.callback.onUnSelected,[i,r,u])})},v=function(n){var i=n.treeObj,t=consts.event;i.unbind(t.NODECREATED).unbind(t.CLICK).unbind(t.EXPAND).unbind(t.COLLAPSE).unbind(t.ASYNC_SUCCESS).unbind(t.ASYNC_ERROR).unbind(t.REMOVE).unbind(t.SELECTED).unbind(t.UNSELECTED)},y=function(n){var o=n.target,i=data.getSetting(n.data.treeId),r="",h=null,u="",e="",c=null,s=null,t=null;if(tools.eqs(n.type,"mousedown")?e="mousedown":tools.eqs(n.type,"mouseup")?e="mouseup":tools.eqs(n.type,"contextmenu")?e="contextmenu":tools.eqs(n.type,"click")?tools.eqs(o.tagName,"span")&&o.getAttribute("treeNode"+consts.id.SWITCH)!==null?(r=tools.getNodeMainDom(o).id,u="switchNode"):(t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id,u="clickNode")):tools.eqs(n.type,"dblclick")&&(e="dblclick",t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id,u="switchNode")),e.length>0&&r.length==0&&(t=tools.getMDom(i,o,[{tagName:"a",attrName:"treeNode"+consts.id.A}]),t&&(r=tools.getNodeMainDom(t).id)),r.length>0){h=data.getNodeCache(i,r);switch(u){case"switchNode":h.isParent?tools.eqs(n.type,"click")||tools.eqs(n.type,"dblclick")&&tools.apply(i.view.dblClickExpand,[i.treeId,h],i.view.dblClickExpand)?c=f.onSwitchNode:u="":u="";break;case"clickNode":c=f.onClickNode}}switch(e){case"mousedown":s=f.onZTreeMousedown;break;case"mouseup":s=f.onZTreeMouseup;break;case"dblclick":s=f.onZTreeDblclick;break;case"contextmenu":s=f.onZTreeContextmenu}return{stop:!1,node:h,nodeEventType:u,nodeEventCallback:c,treeEventType:e,treeEventCallback:s}},p=function(n,t,i,r,u,f){if(i){var o=data.getRoot(n),e=n.data.key.children;i.level=t;i.tId=n.treeId+"_"+ ++o.zId;i.parentTId=r?r.tId:null;i.open=typeof i.open=="string"?tools.eqs(i.open,"true"):!!i.open;i[e]&&i[e].length>0?(i.isParent=!0,i.zAsync=!0):(i.isParent=typeof i.isParent=="string"?tools.eqs(i.isParent,"true"):!!i.isParent,i.open=i.isParent&&!n.async.enable?i.open:!1,i.zAsync=!i.isParent);i.isFirstNode=u;i.isLastNode=f;i.getParentNode=function(){return data.getNodeCache(n,i.parentTId)};i.getPreNode=function(){return data.getPreNode(n,i)};i.getNextNode=function(){return data.getNextNode(n,i)};i.isAjaxing=!1;data.fixPIdKeyValue(n,i)}},i={bind:[a],unbind:[v],caches:[l],nodes:[p],proxys:[y],roots:[c],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(n,t){data.getCache(n).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(n){return n.substring(n.lastIndexOf("_")+1)},addAfterA:function(n){i.afterA.push(n)},addBeforeA:function(n){i.beforeA.push(n)},addInnerAfterA:function(n){i.innerAfterA.push(n)},addInnerBeforeA:function(n){i.innerBeforeA.push(n)},addInitBind:function(n){i.bind.push(n)},addInitUnBind:function(n){i.unbind.push(n)},addInitCache:function(n){i.caches.push(n)},addInitNode:function(n){i.nodes.push(n)},addInitProxy:function(n,t){t?i.proxys.splice(0,0,n):i.proxys.push(n)},addInitRoot:function(n){i.roots.push(n)},addNodesData:function(n,t,i){var r=n.data.key.children;t[r]||(t[r]=[]);t[r].length>0&&(t[r][t[r].length-1].isLastNode=!1,view.setNodeLineIcos(n,t[r][t[r].length-1]));t.isParent=!0;t[r]=t[r].concat(i)},addSelectedNode:function(n,t){var i=data.getRoot(n);data.isSelectedNode(n,t)||i.curSelectedList.push(t)},addCreatedNode:function(n,t){if(!!n.callback.onNodeCreated||!!n.view.addDiyDom){var i=data.getRoot(n);i.createdNodes.push(t)}},addZTreeTools:function(n){i.zTreeTools.push(n)},exSetting:function(t){n.extend(!0,s,t)},fixPIdKeyValue:function(n,t){n.data.simpleData.enable&&(t[n.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[n.data.simpleData.idKey]:n.data.simpleData.rootPId)},getAfterA:function(){for(var n=0,t=i.afterA.length;n<t;n++)i.afterA[n].apply(this,arguments)},getBeforeA:function(){for(var n=0,t=i.beforeA.length;n<t;n++)i.beforeA[n].apply(this,arguments)},getInnerAfterA:function(){for(var n=0,t=i.innerAfterA.length;n<t;n++)i.innerAfterA[n].apply(this,arguments)},getInnerBeforeA:function(){for(var n=0,t=i.innerBeforeA.length;n<t;n++)i.innerBeforeA[n].apply(this,arguments)},getCache:function(n){return o[n.treeId]},getNextNode:function(n,t){var r,u,i,f;if(!t)return null;for(r=n.data.key.children,u=t.parentTId?t.getParentNode():data.getRoot(n),i=0,f=u[r].length-1;i<=f;i++)if(u[r][i]===t)return i==f?null:u[r][i+1];return null},getNodeByParam:function(n,t,i,r){var e,u,o,f;if(!t||!i)return null;for(e=n.data.key.children,u=0,o=t.length;u<o;u++){if(t[u][i]==r)return t[u];if(f=data.getNodeByParam(n,t[u][e],i,r),f)return f}return null},getNodeCache:function(n,t){if(!t)return null;var i=o[n.treeId].nodes[data.getNodeCacheId(t)];return i?i:null},getNodeName:function(n,t){var i=n.data.key.name;return""+t[i]},getNodeTitle:function(n,t){var i=n.data.key.title===""?n.data.key.name:n.data.key.title;return""+t[i]},getNodes:function(n){return data.getRoot(n)[n.data.key.children]},getNodesByParam:function(n,t,i,r){var e,f,u,o;if(!t||!i)return[];for(e=n.data.key.children,f=[],u=0,o=t.length;u<o;u++)t[u][i]==r&&f.push(t[u]),f=f.concat(data.getNodesByParam(n,t[u][e],i,r));return f},getNodesByParamFuzzy:function(n,t,i,r){var e,f,u,o;if(!t||!i)return[];for(e=n.data.key.children,f=[],r=r.toLowerCase(),u=0,o=t.length;u<o;u++)typeof t[u][i]=="string"&&t[u][i].toLowerCase().indexOf(r)>-1&&f.push(t[u]),f=f.concat(data.getNodesByParamFuzzy(n,t[u][e],i,r));return f},getNodesByFilter:function(n,t,i,r,u){var s,e,f,h,o;if(!t)return r?null:[];for(s=n.data.key.children,e=r?null:[],f=0,h=t.length;f<h;f++){if(tools.apply(i,[t[f],u],!1)){if(r)return t[f];e.push(t[f])}if(o=data.getNodesByFilter(n,t[f][s],i,r,u),r&&!!o)return o;e=r?o:e.concat(o)}return e},getPreNode:function(n,t){var r,u,i,f;if(!t)return null;for(r=n.data.key.children,u=t.parentTId?t.getParentNode():data.getRoot(n),i=0,f=u[r].length;i<f;i++)if(u[r][i]===t)return i==0?null:u[r][i-1];return null},getRoot:function(n){return n?e[n.treeId]:null},getRoots:function(){return e},getSetting:function(n){return u[n]},getSettings:function(){return u},getZTreeTools:function(n){var t=this.getRoot(this.getSetting(n));return t?t.treeTools:null},initCache:function(){for(var n=0,t=i.caches.length;n<t;n++)i.caches[n].apply(this,arguments)},initNode:function(){for(var n=0,t=i.nodes.length;n<t;n++)i.nodes[n].apply(this,arguments)},initRoot:function(){for(var n=0,t=i.roots.length;n<t;n++)i.roots[n].apply(this,arguments)},isSelectedNode:function(n,t){for(var r=data.getRoot(n),i=0,u=r.curSelectedList.length;i<u;i++)if(t===r.curSelectedList[i])return!0;return!1},removeNodeCache:function(n,t){var r=n.data.key.children,i,u;if(t[r])for(i=0,u=t[r].length;i<u;i++)arguments.callee(n,t[r][i]);data.getCache(n).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(n,t){for(var r=data.getRoot(n),i=0,u=r.curSelectedList.length;i<u;i++)t!==r.curSelectedList[i]&&data.getNodeCache(n,r.curSelectedList[i].tId)||(r.curSelectedList.splice(i,1),i--,u--)},setCache:function(n,t){o[n.treeId]=t},setRoot:function(n,t){e[n.treeId]=t},setZTreeTools:function(){for(var n=0,t=i.zTreeTools.length;n<t;n++)i.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(n,t){var u,i,r,f;if(!t)return[];if(u=n.data.key.children,i=[],tools.isArray(t))for(r=0,f=t.length;r<f;r++)i.push(t[r]),t[r][u]&&(i=i.concat(data.transformToArrayFormat(n,t[r][u])));else i.push(t),t[u]&&(i=i.concat(data.transformToArrayFormat(n,t[u])));return i},transformTozTreeFormat:function(n,t){var i,f,e=n.data.simpleData.idKey,u=n.data.simpleData.pIdKey,o=n.data.key.children,s,r;if(!e||e==""||!t)return[];if(tools.isArray(t)){for(s=[],r=[],i=0,f=t.length;i<f;i++)r[t[i][e]]=t[i];for(i=0,f=t.length;i<f;i++)r[t[i][u]]&&t[i][e]!=t[i][u]?(r[t[i][u]][o]||(r[t[i][u]][o]=[]),r[t[i][u]][o].push(t[i])):s.push(t[i]);return s}return[t]}},r={bindEvent:function(){for(var n=0,t=i.bind.length;n<t;n++)i.bind[n].apply(this,arguments)},unbindEvent:function(){for(var n=0,t=i.unbind.length;n<t;n++)i.unbind[n].apply(this,arguments)},bindTree:function(n){var i={treeId:n.treeId},t=n.treeObj;n.view.txtSelectedEnable||t.bind("selectstart",function(n){var t=n.originalEvent.srcElement.nodeName.toLowerCase();return t==="input"||t==="textarea"}).css({"-moz-user-select":"-moz-none"});t.bind("click",i,r.proxy);t.bind("dblclick",i,r.proxy);t.bind("mouseover",i,r.proxy);t.bind("mouseout",i,r.proxy);t.bind("mousedown",i,r.proxy);t.bind("mouseup",i,r.proxy);t.bind("contextmenu",i,r.proxy)},unbindTree:function(n){var t=n.treeObj;t.unbind("click",r.proxy).unbind("dblclick",r.proxy).unbind("mouseover",r.proxy).unbind("mouseout",r.proxy).unbind("mousedown",r.proxy).unbind("mouseup",r.proxy).unbind("contextmenu",r.proxy)},doProxy:function(){for(var t,r=[],n=0,u=i.proxys.length;n<u;n++)if(t=i.proxys[n].apply(this,arguments),r.push(t),t.stop)break;return r},proxy:function(n){var s=data.getSetting(n.data.treeId),u,o,t;if(!tools.uCanDo(s,n))return!0;var f=r.doProxy(n),i=!0,e=!1;for(u=0,o=f.length;u<o;u++)t=f[u],t.nodeEventCallback&&(e=!0,i=t.nodeEventCallback.apply(t,[n,t.node])&&i),t.treeEventCallback&&(e=!0,i=t.treeEventCallback.apply(t,[n,t.node])&&i);return i}},f={onSwitchNode:function(n,t){var i=data.getSetting(n.data.treeId);if(t.open){if(tools.apply(i.callback.beforeCollapse,[i.treeId,t],!0)==!1)return!0;data.getRoot(i).expandTriggerFlag=!0;view.switchNode(i,t)}else{if(tools.apply(i.callback.beforeExpand,[i.treeId,t],!0)==!1)return!0;data.getRoot(i).expandTriggerFlag=!0;view.switchNode(i,t)}return!0},onClickNode:function(n,t){var i=data.getSetting(n.data.treeId),r=i.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&data.isSelectedNode(i,t)?0:i.view.autoCancelSelected&&(n.ctrlKey||n.metaKey)&&i.view.selectedMulti?2:1;return tools.apply(i.callback.beforeClick,[i.treeId,t,r],!0)==!1?!0:(r===0?view.cancelPreSelectedNode(i,t):view.selectNode(i,t,r===2),i.treeObj.trigger(consts.event.CLICK,[n,i.treeId,t,r]),!0)},onZTreeMousedown:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeMouseDown,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseDown,[n,i.treeId,t]),!0},onZTreeMouseup:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeMouseUp,[i.treeId,t],!0)&&tools.apply(i.callback.onMouseUp,[n,i.treeId,t]),!0},onZTreeDblclick:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeDblClick,[i.treeId,t],!0)&&tools.apply(i.callback.onDblClick,[n,i.treeId,t]),!0},onZTreeContextmenu:function(n,t){var i=data.getSetting(n.data.treeId);return tools.apply(i.callback.beforeRightClick,[i.treeId,t],!0)&&tools.apply(i.callback.onRightClick,[n,i.treeId,t]),typeof i.callback.onRightClick!="function"}},tools={apply:function(n,t,i){return typeof n=="function"?n.apply(h,t?t:[]):i},canAsync:function(n,t){var i=n.data.key.children;return n.async.enable&&t&&t.isParent&&!(t.zAsync||t[i]&&t[i].length>0)},clone:function(n){var i,t;if(n===null)return null;i=tools.isArray(n)?[]:{};for(t in n)i[t]=n[t]instanceof Date?new Date(n[t].getTime()):typeof n[t]=="object"?arguments.callee(n[t]):n[t];return i},eqs:function(n,t){return n.toLowerCase()===t.toLowerCase()},isArray:function(n){return Object.prototype.toString.apply(n)==="[object Array]"},$:function(t,i,r){return!i||typeof i=="string"||(r=i,i=""),typeof t=="string"?n(t,r?r.treeObj.get(0).ownerDocument:null):n("#"+t.tId+i,r?r.treeObj:null)},getMDom:function(n,t,i){if(!t)return null;while(t&&t.id!==n.treeId){for(var r=0,u=i.length;t.tagName&&r<u;r++)if(tools.eqs(t.tagName,i[r].tagName)&&t.getAttribute(i[r].attrName)!==null)return t;t=t.parentNode}return null},getNodeMainDom:function(t){return n(t).parent("li").get(0)||n(t).parentsUntil("li").parent().get(0)},isChildOrSelf:function(t,i){return n(t).closest("#"+i).length>0},uCanDo:function(){return!0}},view={addNodes:function(n,i,r,u){if(!n.data.keep.leaf||!i||i.isParent)if(tools.isArray(r)||(r=[r]),n.data.simpleData.enable&&(r=data.transformTozTreeFormat(n,r)),i){var f=t(i,consts.id.SWITCH,n),e=t(i,consts.id.ICON,n),o=t(i,consts.id.UL,n);i.open||(view.replaceSwitchClass(i,f,consts.folder.CLOSE),view.replaceIcoClass(i,e,consts.folder.CLOSE),i.open=!1,o.css({display:"none"}));data.addNodesData(n,i,r);view.createNodes(n,i.level+1,r,i);u||view.expandCollapseParentNode(n,i,!0)}else data.addNodesData(n,data.getRoot(n),r),view.createNodes(n,0,r,null)},appendNodes:function(n,t,i,r,u,f){var o,h,s,l,e,c;if(!i)return[];for(o=[],h=n.data.key.children,s=0,l=i.length;s<l;s++){if(e=i[s],u){var a=r?r:data.getRoot(n),v=a[h],y=v.length==i.length&&s==0,p=s==i.length-1;data.initNode(n,t,e,r,y,p,f);data.addNodeCache(n,e)}c=[];e[h]&&e[h].length>0&&(c=view.appendNodes(n,t+1,e[h],e,u,f&&e.open));f&&(view.makeDOMNodeMainBefore(o,n,e),view.makeDOMNodeLine(o,n,e),data.getBeforeA(n,e,o),view.makeDOMNodeNameBefore(o,n,e),data.getInnerBeforeA(n,e,o),view.makeDOMNodeIcon(o,n,e),data.getInnerAfterA(n,e,o),view.makeDOMNodeNameAfter(o,n,e),data.getAfterA(n,e,o),e.isParent&&e.open&&view.makeUlHtml(n,e,o,c.join("")),view.makeDOMNodeMainAfter(o,n,e),data.addCreatedNode(n,e))}return o},appendParentULDom:function(n,i){var f=[],r=t(i,n),u,e,o;r.get(0)||!i.parentTId||(view.appendParentULDom(n,i.getParentNode()),r=t(i,n));u=t(i,consts.id.UL,n);u.get(0)&&u.remove();e=n.data.key.children;o=view.appendNodes(n,i.level+1,i[e],i,!1,!0);view.makeUlHtml(n,i,f,o.join(""));r.append(f.join(""))},asyncNode:function(setting,node,isSilent,callback){var i,f,s,u,r,e,o,_tmpV;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0)==!1)return tools.apply(callback),!1;for(node&&(node.isAjaxing=!0,s=t(node,consts.id.ICON,setting),s.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})),u={},i=0,f=setting.async.autoParam.length;node&&i<f;i++)r=setting.async.autoParam[i].split("="),e=r,r.length>1&&(e=r[1],r=r[0]),u[e]=node[r];if(tools.isArray(setting.async.otherParam))for(i=0,f=setting.async.otherParam.length;i<f;i+=2)u[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(o in setting.async.otherParam)u[o]=setting.async.otherParam[o];return _tmpV=data.getRoot(setting)._ver,n.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:u,dataType:setting.async.dataType,success:function(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&msg.length!=0?typeof msg=="string"?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0);view.setNodeLineIcos(setting,node);newNodes&&newNodes!==""?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,!newNodes?[]:tools.clone(newNodes),!!isSilent)):view.addNodes(setting,node,[],!!isSilent);setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]);tools.apply(callback)}},error:function(n,t,i){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,n,t,i]))}}),!0},cancelPreSelectedNode:function(n,i,u){for(var o=data.getRoot(n).curSelectedList,f,e=o.length-1;e>=0;e--)if(f=o[e],i===f||!i&&(!u||u!==f))if(t(f,consts.id.A,n).removeClass(consts.node.CURSELECTED),i){data.removeSelectedNode(n,i);n.treeObj.trigger(consts.event.UNSELECTED,[r,n.treeId,f]);break}else o.splice(e,1),n.treeObj.trigger(consts.event.UNSELECTED,[r,n.treeId,f])},createNodeCallback:function(n){var t,i;if(!!n.callback.onNodeCreated||!!n.view.addDiyDom)for(t=data.getRoot(n);t.createdNodes.length>0;)i=t.createdNodes.shift(),tools.apply(n.view.addDiyDom,[n.treeId,i]),!n.callback.onNodeCreated||n.treeObj.trigger(consts.event.NODECREATED,[n.treeId,i])},createNodes:function(n,i,r,u){var f,e;if(r&&r.length!=0){var o=data.getRoot(n),s=n.data.key.children,h=!u||u.open||!!t(u[s][0],n).get(0);o.createdNodes=[];f=view.appendNodes(n,i,r,u,!0,h);u?(e=t(u,consts.id.UL,n),e.get(0)&&e.append(f.join(""))):n.treeObj.append(f.join(""));view.createNodeCallback(n)}},destroy:function(n){n&&(data.initCache(n),data.initRoot(n),r.unbindTree(n),r.unbindEvent(n),n.treeObj.empty(),delete u[n.treeId])},expandCollapseNode:function(n,i,r,u,f){var c=data.getRoot(n),e=n.data.key.children,s;if(!i){tools.apply(f,[]);return}if(c.expandTriggerFlag&&(s=f,f=function(){s&&s();i.open?n.treeObj.trigger(consts.event.EXPAND,[n.treeId,i]):n.treeObj.trigger(consts.event.COLLAPSE,[n.treeId,i])},c.expandTriggerFlag=!1),!i.open&&i.isParent&&(!t(i,consts.id.UL,n).get(0)||i[e]&&i[e].length>0&&!t(i[e][0],n).get(0))&&(view.appendParentULDom(n,i),view.createNodeCallback(n)),i.open==r){tools.apply(f,[]);return}var o=t(i,consts.id.UL,n),l=t(i,consts.id.SWITCH,n),h=t(i,consts.id.ICON,n);i.isParent?(i.open=!i.open,i.iconOpen&&i.iconClose&&h.attr("style",view.makeNodeIcoStyle(n,i)),i.open?(view.replaceSwitchClass(i,l,consts.folder.OPEN),view.replaceIcoClass(i,h,consts.folder.OPEN),u==!1||n.view.expandSpeed==""?(o.show(),tools.apply(f,[])):i[e]&&i[e].length>0?o.slideDown(n.view.expandSpeed,f):(o.show(),tools.apply(f,[]))):(view.replaceSwitchClass(i,l,consts.folder.CLOSE),view.replaceIcoClass(i,h,consts.folder.CLOSE),u!=!1&&n.view.expandSpeed!=""&&i[e]&&i[e].length>0?o.slideUp(n.view.expandSpeed,f):(o.hide(),tools.apply(f,[])))):tools.apply(f,[])},expandCollapseParentNode:function(n,t,i,r,u){if(t){if(t.parentTId)view.expandCollapseNode(n,t,i,r);else{view.expandCollapseNode(n,t,i,r,u);return}t.parentTId&&view.expandCollapseParentNode(n,t.getParentNode(),i,r,u)}},expandCollapseSonNode:function(n,t,i,r,u){var h=data.getRoot(n),o=n.data.key.children,e=t?t[o]:h[o],c=t?!1:r,l=data.getRoot(n).expandTriggerFlag,f,s;if(data.getRoot(n).expandTriggerFlag=!1,e)for(f=0,s=e.length;f<s;f++)e[f]&&view.expandCollapseSonNode(n,e[f],i,c);data.getRoot(n).expandTriggerFlag=l;view.expandCollapseNode(n,t,i,r,u)},isSelectedNode:function(n,t){if(!t)return!1;for(var r=data.getRoot(n).curSelectedList,i=r.length-1;i>=0;i--)if(t===r[i])return!0;return!1},makeDOMNodeIcon:function(n,t,i){var r=data.getNodeName(t,i),u=t.view.nameIsHTML?r:r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");n.push("<span id='",i.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,i),"' style='",view.makeNodeIcoStyle(t,i),"'><\/span><span id='",i.tId,consts.id.SPAN,"'>",u,"<\/span>")},makeDOMNodeLine:function(n,t,i){n.push("<span id='",i.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,i),"' treeNode",consts.id.SWITCH,"><\/span>")},makeDOMNodeMainAfter:function(n){n.push("<\/li>")},makeDOMNodeMainBefore:function(n,t,i){n.push("<li id='",i.tId,"' class='",consts.className.LEVEL,i.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(n){n.push("<\/a>")},makeDOMNodeNameBefore:function(n,t,i){var u=data.getNodeTitle(t,i),r=view.makeNodeUrl(t,i),f=view.makeNodeFontCss(t,i),e=[];for(var o in f)e.push(o,":",f[o],";");n.push("<a id='",i.tId,consts.id.A,"' class='",consts.className.LEVEL,i.level,"' treeNode",consts.id.A,' onclick="',i.click||"",'" ',r!=null&&r.length>0?"href='"+r+"'":""," target='",view.makeNodeTarget(i),"' style='",e.join(""),"'");tools.apply(t.view.showTitle,[t.treeId,i],t.view.showTitle)&&u&&n.push("title='",u.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");n.push(">")},makeNodeFontCss:function(n,t){var i=tools.apply(n.view.fontCss,[n.treeId,t],n.view.fontCss);return i&&typeof i!="function"?i:{}},makeNodeIcoClass:function(n,t){var i=["ico"];return t.isAjaxing||(i[0]=(t.iconSkin?t.iconSkin+"_":"")+i[0],t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU)),consts.className.BUTTON+" "+i.join("_")},makeNodeIcoStyle:function(n,t){var i=[],r;return t.isAjaxing||(r=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t.icon,r&&i.push("background:url(",r,") 0 0 no-repeat;"),n.view.showIcon!=!1&&tools.apply(n.view.showIcon,[n.treeId,t],!0)||i.push("width:0px;height:0px;")),i.join("")},makeNodeLineClass:function(n,t){var i=[];return n.view.showLine?t.level==0&&t.isFirstNode&&t.isLastNode?i.push(consts.line.ROOT):t.level==0&&t.isFirstNode?i.push(consts.line.ROOTS):t.isLastNode?i.push(consts.line.BOTTOM):i.push(consts.line.CENTER):i.push(consts.line.NOLINE),t.isParent?i.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):i.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+i.join("_")},makeNodeLineClassEx:function(n){return consts.className.BUTTON+" "+consts.className.LEVEL+n.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(n){return n.target||"_blank"},makeNodeUrl:function(n,t){var i=n.data.key.url;return t[i]?t[i]:null},makeUlHtml:function(n,t,i,r){i.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(n,t),"' style='display:",t.open?"block":"none","'>");i.push(r);i.push("<\/ul>")},makeUlLineClass:function(n,t){return n.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(n,i){var f,r,u,e,o,s;if(i&&(f=n.data.key.children,r=i[f],r)){for(u=0,e=r.length;u<e;u++)data.removeNodeCache(n,r[u]);data.removeSelectedNode(n);delete i[f];n.data.keep.parent?t(i,consts.id.UL,n).empty():(i.isParent=!1,i.open=!1,o=t(i,consts.id.SWITCH,n),s=t(i,consts.id.ICON,n),view.replaceSwitchClass(i,o,consts.folder.DOCU),view.replaceIcoClass(i,s,consts.folder.DOCU),t(i,consts.id.UL,n).remove())}},setFirstNode:function(n,t){var i=n.data.key.children,r=t[i].length;r>0&&(t[i][0].isFirstNode=!0)},setLastNode:function(n,t){var i=n.data.key.children,r=t[i].length;r>0&&(t[i][r-1].isLastNode=!0)},removeNode:function(n,i){var l=data.getRoot(n),u=n.data.key.children,r=i.parentTId?i.getParentNode():l,o,a,s,e,c,h,f,v;if(i.isFirstNode=!1,i.isLastNode=!1,i.getPreNode=function(){return null},i.getNextNode=function(){return null},data.getNodeCache(n,i.tId)){for(t(i,n).remove(),data.removeNodeCache(n,i),data.removeSelectedNode(n,i),o=0,a=r[u].length;o<a;o++)if(r[u][o].tId==i.tId){r[u].splice(o,1);break}view.setFirstNode(n,r);view.setLastNode(n,r);h=r[u].length;n.data.keep.parent||h!=0?n.view.showLine&&h>0&&(f=r[u][h-1],s=t(f,consts.id.UL,n),e=t(f,consts.id.SWITCH,n),c=t(f,consts.id.ICON,n),r==l?r[u].length==1?view.replaceSwitchClass(f,e,consts.line.ROOT):(v=t(r[u][0],consts.id.SWITCH,n),view.replaceSwitchClass(r[u][0],v,consts.line.ROOTS),view.replaceSwitchClass(f,e,consts.line.BOTTOM)):view.replaceSwitchClass(f,e,consts.line.BOTTOM),s.removeClass(consts.line.LINE)):(r.isParent=!1,r.open=!1,s=t(r,consts.id.UL,n),e=t(r,consts.id.SWITCH,n),c=t(r,consts.id.ICON,n),view.replaceSwitchClass(r,e,consts.folder.DOCU),view.replaceIcoClass(r,c,consts.folder.DOCU),s.css("display","none"))}},replaceIcoClass:function(n,t,i){var u,r;if(t&&!n.isAjaxing&&(u=t.attr("class"),u!=undefined)){r=u.split("_");switch(i){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[r.length-1]=i}t.attr("class",r.join("_"))}},replaceSwitchClass:function(n,t,i){var u,r;if(t&&(u=t.attr("class"),u!=undefined)){r=u.split("_");switch(i){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:r[0]=view.makeNodeLineClassEx(n)+i;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:r[1]=i}t.attr("class",r.join("_"));i!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}},selectNode:function(n,i,u){u||view.cancelPreSelectedNode(n,null,i);t(i,consts.id.A,n).addClass(consts.node.CURSELECTED);data.addSelectedNode(n,i);n.treeObj.trigger(consts.event.SELECTED,[r,n.treeId,i])},setNodeFontCss:function(n,i){var u=t(i,consts.id.A,n),r=view.makeNodeFontCss(n,i);r&&u.css(r)},setNodeLineIcos:function(n,i){if(i){var r=t(i,consts.id.SWITCH,n),f=t(i,consts.id.UL,n),u=t(i,consts.id.ICON,n),e=view.makeUlLineClass(n,i);e.length==0?f.removeClass(consts.line.LINE):f.addClass(e);r.attr("class",view.makeNodeLineClass(n,i));i.isParent?r.removeAttr("disabled"):r.attr("disabled","disabled");u.removeAttr("style");u.attr("style",view.makeNodeIcoStyle(n,i));u.attr("class",view.makeNodeIcoClass(n,i))}},setNodeName:function(n,i){var u=data.getNodeTitle(n,i),r=t(i,consts.id.SPAN,n),f;r.empty();n.view.nameIsHTML?r.html(data.getNodeName(n,i)):r.text(data.getNodeName(n,i));tools.apply(n.view.showTitle,[n.treeId,i],n.view.showTitle)&&(f=t(i,consts.id.A,n),f.attr("title",u?u:""))},setNodeTarget:function(n,i){var r=t(i,consts.id.A,n);r.attr("target",view.makeNodeTarget(i))},setNodeUrl:function(n,i){var u=t(i,consts.id.A,n),r=view.makeNodeUrl(n,i);r==null||r.length==0?u.removeAttr("href"):u.attr("href",r)},switchNode:function(n,t){if(t.open||!tools.canAsync(n,t))view.expandCollapseNode(n,t,!t.open);else if(n.async.enable){if(!view.asyncNode(n,t)){view.expandCollapseNode(n,t,!t.open);return}}else t&&view.expandCollapseNode(n,t,!t.open)}};n.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:tools,view:view,event:r,data:data},getZTreeObj:function(n){var t=data.getZTreeTools(n);return t?t:null},destroy:function(n){if(!!n&&n.length>0)view.destroy(data.getSetting(n));else for(var t in u)view.destroy(u[t])},init:function(i,f,e){var o=tools.clone(s),h,c,l;return n.extend(!0,o,f),o.treeId=i.attr("id"),o.treeObj=i,o.treeObj.empty(),u[o.treeId]=o,typeof document.body.style.maxHeight=="undefined"&&(o.view.expandSpeed=""),data.initRoot(o),h=data.getRoot(o),c=o.data.key.children,e=e?tools.clone(tools.isArray(e)?e:[e]):[],h[c]=o.data.simpleData.enable?data.transformTozTreeFormat(o,e):e,data.initCache(o),r.unbindTree(o),r.bindTree(o),r.unbindEvent(o),r.bindEvent(o),l={setting:o,addNodes:function(n,t,i){function u(){view.addNodes(o,n,r,i==!0)}if(!t||(n||(n=null),n&&!n.isParent&&o.data.keep.leaf))return null;var r=tools.clone(tools.isArray(t)?t:[t]);return tools.canAsync(o,n)?view.asyncNode(o,n,i,u):u(),r},cancelSelectedNode:function(n){view.cancelPreSelectedNode(o,n)},destroy:function(){view.destroy(o)},expandAll:function(n){return n=!!n,view.expandCollapseSonNode(o,null,n,!0),n},expandNode:function(n,i,r,u,f){if(!n||!n.isParent||(i!==!0&&i!==!1&&(i=!n.open),f=!!f,f&&i&&tools.apply(o.callback.beforeExpand,[o.treeId,n],!0)==!1)||f&&!i&&tools.apply(o.callback.beforeCollapse,[o.treeId,n],!0)==!1||(i&&n.parentTId&&view.expandCollapseParentNode(o,n.getParentNode(),i,!1),i===n.open&&!r))return null;if(data.getRoot(o).expandTriggerFlag=f,!tools.canAsync(o,n)&&r)view.expandCollapseSonNode(o,n,i,!0,function(){if(u!==!1)try{t(n,o).focus().blur()}catch(i){}});else if(n.open=!i,view.switchNode(this.setting,n),u!==!1)try{t(n,o).focus().blur()}catch(e){}return i},getNodes:function(){return data.getNodes(o)},getNodeByParam:function(n,t,i){return n?data.getNodeByParam(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodeByTId:function(n){return data.getNodeCache(o,n)},getNodesByParam:function(n,t,i){return n?data.getNodesByParam(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodesByParamFuzzy:function(n,t,i){return n?data.getNodesByParamFuzzy(o,i?i[o.data.key.children]:data.getNodes(o),n,t):null},getNodesByFilter:function(n,t,i,r){return(t=!!t,!n||typeof n!="function")?t?null:[]:data.getNodesByFilter(o,i?i[o.data.key.children]:data.getNodes(o),n,t,r)},getNodeIndex:function(n){var i,r,t,u;if(!n)return null;for(i=o.data.key.children,r=n.parentTId?n.getParentNode():data.getRoot(o),t=0,u=r[i].length;t<u;t++)if(r[i][t]==n)return t;return-1},getSelectedNodes:function(){for(var t=[],i=data.getRoot(o).curSelectedList,n=0,r=i.length;n<r;n++)t.push(i[n]);return t},isSelectedNode:function(n){return data.isSelectedNode(o,n)},reAsyncChildNodes:function(n,i,r){var f,u,e,s,h;if(this.setting.async.enable){if(f=!n,f&&(n=data.getRoot(o)),i=="refresh"){for(u=this.setting.data.key.children,e=0,s=n[u]?n[u].length:0;e<s;e++)data.removeNodeCache(o,n[u][e]);data.removeSelectedNode(o);n[u]=[];f?this.setting.treeObj.empty():(h=t(n,consts.id.UL,o),h.empty())}view.asyncNode(this.setting,f?null:n,!!r)}},refresh:function(){this.setting.treeObj.empty();var n=data.getRoot(o),t=n[o.data.key.children];data.initRoot(o);n[o.data.key.children]=t;data.initCache(o);view.createNodes(o,0,n[o.data.key.children])},removeChildNodes:function(n){if(!n)return null;var i=o.data.key.children,t=n[i];return view.removeChildNodes(o,n),t?t:null},removeNode:function(n,t){n&&((t=!!t,t&&tools.apply(o.callback.beforeRemove,[o.treeId,n],!0)==!1)||(view.removeNode(o,n),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[o.treeId,n])))},selectNode:function(n,i){if(n&&tools.uCanDo(o)){if(i=o.view.selectedMulti&&i,n.parentTId)view.expandCollapseParentNode(o,n.getParentNode(),!0,!1,function(){try{t(n,o).focus().blur()}catch(i){}});else try{t(n,o).focus().blur()}catch(r){}view.selectNode(o,n,i)}},transformTozTreeNodes:function(n){return data.transformTozTreeFormat(o,n)},transformToArray:function(n){return data.transformToArrayFormat(o,n)},updateNode:function(n){if(n){var i=t(n,o);i.get(0)&&tools.uCanDo(o)&&(view.setNodeName(o,n),view.setNodeTarget(o,n),view.setNodeUrl(o,n),view.setNodeLineIcos(o,n),view.setNodeFontCss(o,n))}}},h.treeTools=l,data.setZTreeTools(o,l),h[c]&&h[c].length>0?view.createNodes(o,0,h[c]):o.async.enable&&o.async.url&&o.async.url!==""&&view.asyncNode(o),l}};var h=n.fn.zTree,t=tools.$,consts=h.consts})(jQuery),function(n){var o={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},a={check:{enable:!1,autoCheckTrigger:!1,chkStyle:o.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:o.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},v=function(n){var t=r.getRoot(n);t.radioCheckedList=[]},y=function(){},p=function(n){var t=n.treeObj,r=i.event;t.bind(r.CHECK,function(t,i,r,f){t.srcEvent=i;u.apply(n.callback.onCheck,[t,r,f])})},w=function(n){var t=n.treeObj,r=i.event;t.unbind(r.CHECK)},b=function(n){var t=n.target,o=r.getSetting(n.data.treeId),e="",c=null,f="",h=null;if(u.eqs(n.type,"mouseover")?o.check.enable&&u.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+i.id.CHECK)!==null&&(e=u.getNodeMainDom(t).id,f="mouseoverCheck"):u.eqs(n.type,"mouseout")?o.check.enable&&u.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+i.id.CHECK)!==null&&(e=u.getNodeMainDom(t).id,f="mouseoutCheck"):u.eqs(n.type,"click")&&o.check.enable&&u.eqs(t.tagName,"span")&&t.getAttribute("treeNode"+i.id.CHECK)!==null&&(e=u.getNodeMainDom(t).id,f="checkNode"),e.length>0){c=r.getNodeCache(o,e);switch(f){case"checkNode":h=s.onCheckNode;break;case"mouseoverCheck":h=s.onMouseoverCheck;break;case"mouseoutCheck":h=s.onMouseoutCheck}}return{stop:f==="checkNode",node:c,nodeEventType:f,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}},k=function(n,t,f,e){var o,s;f&&(o=n.data.key.checked,typeof f[o]=="string"&&(f[o]=u.eqs(f[o],"true")),f[o]=!!f[o],f.checkedOld=f[o],typeof f.nocheck=="string"&&(f.nocheck=u.eqs(f.nocheck,"true")),f.nocheck=!!f.nocheck||n.check.nocheckInherit&&e&&!!e.nocheck,typeof f.chkDisabled=="string"&&(f.chkDisabled=u.eqs(f.chkDisabled,"true")),f.chkDisabled=!!f.chkDisabled||n.check.chkDisabledInherit&&e&&!!e.chkDisabled,typeof f.halfCheck=="string"&&(f.halfCheck=u.eqs(f.halfCheck,"true")),f.halfCheck=!!f.halfCheck,f.check_Child_State=-1,f.check_Focus=!1,f.getCheckStatus=function(){return r.getCheckStatus(n,f)},n.check.chkStyle==i.radio.STYLE&&n.check.radioType==i.radio.TYPE_ALL&&f[o]&&(s=r.getRoot(n),s.radioCheckedList.push(f)))},d=function(n,u,f){var e=n.data.key.checked;n.check.enable&&(r.makeChkFlag(n,u),f.push("<span ID='",u.tId,i.id.CHECK,"' class='",t.makeChkClass(n,u),"' treeNode",i.id.CHECK,u.nocheck===!0?" style='display:none;'":"","><\/span>"))},g=function(n,e){e.checkNode=function(n,r,e,o){var s=this.setting.data.key.checked,h;if(n.chkDisabled!==!0){if(r!==!0&&r!==!1&&(r=!n[s]),o=!!o,n[s]!==r||e){if(o&&u.apply(this.setting.callback.beforeCheck,[this.setting.treeId,n],!0)==!1)return}else return;u.uCanDo(this.setting)&&this.setting.check.enable&&n.nocheck!==!0&&(n[s]=r,h=f(n,i.id.CHECK,this.setting),(e||this.setting.check.chkStyle===i.radio.STYLE)&&t.checkNodeRelation(this.setting,n),t.setChkClass(this.setting,h,n),t.repairParentChkClassWithSelf(this.setting,n),o&&this.setting.treeObj.trigger(i.event.CHECK,[null,this.setting.treeId,n]))}};e.checkAllNodes=function(n){t.repairAllChk(this.setting,!!n)};e.getCheckedNodes=function(n){var t=this.setting.data.key.children;return n=n!==!1,r.getTreeCheckedNodes(this.setting,r.getRoot(this.setting)[t],n)};e.getChangeCheckedNodes=function(){var n=this.setting.data.key.children;return r.getTreeChangeCheckedNodes(this.setting,r.getRoot(this.setting)[n])};e.setChkDisabled=function(n,i,r,u){i=!!i;r=!!r;u=!!u;t.repairSonChkDisabled(this.setting,n,i,u);t.repairParentChkDisabled(this.setting,n.getParentNode(),i,r)};var o=e.updateNode;e.updateNode=function(n,r){var s,h;(o&&o.apply(e,arguments),n&&this.setting.check.enable)&&(s=f(n,this.setting),s.get(0)&&u.uCanDo(this.setting)&&(h=f(n,i.id.CHECK,this.setting),(r==!0||this.setting.check.chkStyle===i.radio.STYLE)&&t.checkNodeRelation(this.setting,n),t.setChkClass(this.setting,h,n),t.repairParentChkClassWithSelf(this.setting,n)))}},nt={getRadioCheckedList:function(n){for(var i=r.getRoot(n).radioCheckedList,t=0,u=i.length;t<u;t++)r.getNodeCache(n,i[t].tId)||(i.splice(t,1),t--,u--);return i},getCheckStatus:function(n,t){if(!n.check.enable||t.nocheck||t.chkDisabled)return null;var r=n.data.key.checked;return{checked:t[r],half:t.halfCheck?t.halfCheck:n.check.chkStyle==i.radio.STYLE?t.check_Child_State===2:t[r]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(n,t,u,f){var e,s;if(!t)return[];var h=n.data.key.children,c=n.data.key.checked,o=u&&n.check.chkStyle==i.radio.STYLE&&n.check.radioType==i.radio.TYPE_ALL;for(f=f?f:[],e=0,s=t.length;e<s;e++){if(t[e].nocheck!==!0&&t[e].chkDisabled!==!0&&t[e][c]==u&&(f.push(t[e]),o))break;if(r.getTreeCheckedNodes(n,t[e][h],u,f),o&&f.length>0)break}return f},getTreeChangeCheckedNodes:function(n,t,i){var f,e,u,o;if(!t)return[];for(f=n.data.key.children,e=n.data.key.checked,i=i?i:[],u=0,o=t.length;u<o;u++)t[u].nocheck!==!0&&t[u].chkDisabled!==!0&&t[u][e]!=t[u].checkedOld&&i.push(t[u]),r.getTreeChangeCheckedNodes(n,t[u][f],i);return i},makeChkFlag:function(n,t){var e,h,r,u;if(t){var o=n.data.key.children,s=n.data.key.checked,f=-1;if(t[o])for(e=0,h=t[o].length;e<h;e++)if(r=t[o][e],u=-1,n.check.chkStyle==i.radio.STYLE)if(u=r.nocheck===!0||r.chkDisabled===!0?r.check_Child_State:r.halfCheck===!0?2:r[s]?2:r.check_Child_State>0?2:0,u==2){f=2;break}else u==0&&(f=0);else if(n.check.chkStyle==i.checkbox.STYLE)if(u=r.nocheck===!0||r.chkDisabled===!0?r.check_Child_State:r.halfCheck===!0?1:r[s]?r.check_Child_State===-1||r.check_Child_State===2?2:1:r.check_Child_State>0?1:0,u===1){f=1;break}else if(u===2&&f>-1&&e>0&&u!==f){f=1;break}else if(f===2&&u>-1&&u<2){f=1;break}else u>-1&&(f=u);t.check_Child_State=f}}},s={onCheckNode:function(n,e){var o,s,h;return e.chkDisabled===!0?!1:(o=r.getSetting(n.data.treeId),s=o.data.key.checked,u.apply(o.callback.beforeCheck,[o.treeId,e],!0)==!1)?!0:(e[s]=!e[s],t.checkNodeRelation(o,e),h=f(e,i.id.CHECK,o),t.setChkClass(o,h,e),t.repairParentChkClassWithSelf(o,e),o.treeObj.trigger(i.event.CHECK,[n,o.treeId,e]),!0)},onMouseoverCheck:function(n,u){if(u.chkDisabled===!0)return!1;var e=r.getSetting(n.data.treeId),o=f(u,i.id.CHECK,e);return u.check_Focus=!0,t.setChkClass(e,o,u),!0},onMouseoutCheck:function(n,u){if(u.chkDisabled===!0)return!1;var e=r.getSetting(n.data.treeId),o=f(u,i.id.CHECK,e);return u.check_Focus=!1,t.setChkClass(e,o,u),!0}},tt={checkNodeRelation:function(n,u){var e,o,l,c=n.data.key.children,s=n.data.key.checked,a=i.radio,h,v;if(n.check.chkStyle==a.STYLE){if(h=r.getRadioCheckedList(n),u[s])if(n.check.radioType==a.TYPE_ALL){for(o=h.length-1;o>=0;o--)e=h[o],e[s]&&e!=u&&(e[s]=!1,h.splice(o,1),t.setChkClass(n,f(e,i.id.CHECK,n),e),e.parentTId!=u.parentTId&&t.repairParentChkClassWithSelf(n,e));h.push(u)}else for(v=u.parentTId?u.getParentNode():r.getRoot(n),o=0,l=v[c].length;o<l;o++)e=v[c][o],e[s]&&e!=u&&(e[s]=!1,t.setChkClass(n,f(e,i.id.CHECK,n),e));else if(n.check.radioType==a.TYPE_ALL)for(o=0,l=h.length;o<l;o++)if(u==h[o]){h.splice(o,1);break}}else u[s]&&(!u[c]||u[c].length==0||n.check.chkboxType.Y.indexOf("s")>-1)&&t.setSonNodeCheckBox(n,u,!0),!u[s]&&(!u[c]||u[c].length==0||n.check.chkboxType.N.indexOf("s")>-1)&&t.setSonNodeCheckBox(n,u,!1),u[s]&&n.check.chkboxType.Y.indexOf("p")>-1&&t.setParentNodeCheckBox(n,u,!0),!u[s]&&n.check.chkboxType.N.indexOf("p")>-1&&t.setParentNodeCheckBox(n,u,!1)},makeChkClass:function(n,t){var f=n.data.key.checked,r=i.checkbox,o=i.radio,e="",u;return e=t.chkDisabled===!0?r.DISABLED:t.halfCheck?r.PART:n.check.chkStyle==o.STYLE?t.check_Child_State<1?r.FULL:r.PART:t[f]?t.check_Child_State===2||t.check_Child_State===-1?r.FULL:r.PART:t.check_Child_State<1?r.FULL:r.PART,u=n.check.chkStyle+"_"+(t[f]?r.TRUE:r.FALSE)+"_"+e,u=t.check_Focus&&t.chkDisabled!==!0?u+"_"+r.FOCUS:u,i.className.BUTTON+" "+r.DEFAULT+" "+u},repairAllChk:function(n,u){var e,h,f;if(n.check.enable&&n.check.chkStyle===i.checkbox.STYLE){var c=n.data.key.checked,o=n.data.key.children,s=r.getRoot(n);for(e=0,h=s[o].length;e<h;e++)f=s[o][e],f.nocheck!==!0&&f.chkDisabled!==!0&&(f[c]=u),t.setSonNodeCheckBox(n,f,u)}},repairChkClass:function(n,u){if(u&&(r.makeChkFlag(n,u),u.nocheck!==!0)){var e=f(u,i.id.CHECK,n);t.setChkClass(n,e,u)}},repairParentChkClass:function(n,i){if(i&&i.parentTId){var r=i.getParentNode();t.repairChkClass(n,r);t.repairParentChkClass(n,r)}},repairParentChkClassWithSelf:function(n,i){if(i){var r=n.data.key.children;i[r]&&i[r].length>0?t.repairParentChkClass(n,i[r][0]):t.repairParentChkClass(n,i)}},repairSonChkDisabled:function(n,i,r,u){var f,e,o,s;if(i&&(f=n.data.key.children,i.chkDisabled!=r&&(i.chkDisabled=r),t.repairChkClass(n,i),i[f]&&u))for(e=0,o=i[f].length;e<o;e++)s=i[f][e],t.repairSonChkDisabled(n,s,r,u)},repairParentChkDisabled:function(n,i,r,u){i&&(i.chkDisabled!=r&&u&&(i.chkDisabled=r),t.repairChkClass(n,i),t.repairParentChkDisabled(n,i.getParentNode(),r,u))},setChkClass:function(n,i,r){i&&(r.nocheck===!0?i.hide():i.show(),i.attr("class",t.makeChkClass(n,r)))},setParentNodeCheckBox:function(n,u,e,o){var v=n.data.key.children,l=n.data.key.checked,y=f(u,i.id.CHECK,n),c,h,s,a;if(o||(o=u),r.makeChkFlag(n,u),u.nocheck!==!0&&u.chkDisabled!==!0&&(u[l]=e,t.setChkClass(n,y,u),n.check.autoCheckTrigger&&u!=o&&n.treeObj.trigger(i.event.CHECK,[null,n.treeId,u])),u.parentTId){if(c=!0,!e)for(h=u.getParentNode()[v],s=0,a=h.length;s<a;s++)if(h[s].nocheck!==!0&&h[s].chkDisabled!==!0&&h[s][l]||(h[s].nocheck===!0||h[s].chkDisabled===!0)&&h[s].check_Child_State>0){c=!1;break}c&&t.setParentNodeCheckBox(n,u.getParentNode(),e,o)}},setSonNodeCheckBox:function(n,u,e,o){var h,c,a,l;if(u){var s=n.data.key.children,v=n.data.key.checked,y=f(u,i.id.CHECK,n);if(o||(o=u),h=!1,u[s])for(c=0,a=u[s].length;c<a&&u.chkDisabled!==!0;c++)l=u[s][c],t.setSonNodeCheckBox(n,l,e,o),l.chkDisabled===!0&&(h=!0);u!=r.getRoot(n)&&u.chkDisabled!==!0&&(h&&u.nocheck!==!0&&r.makeChkFlag(n,u),u.nocheck!==!0&&u.chkDisabled!==!0?(u[v]=e,h||(u.check_Child_State=u[s]&&u[s].length>0?e?2:0:-1)):u.check_Child_State=-1,t.setChkClass(n,y,u),n.check.autoCheckTrigger&&u!=o&&u.nocheck!==!0&&u.chkDisabled!==!0&&n.treeObj.trigger(i.event.CHECK,[null,n.treeId,u]))}}},it={tools:{},view:tt,event:{},data:nt},h,c,l;n.extend(!0,n.fn.zTree.consts,o);n.extend(!0,n.fn.zTree._z,it);var e=n.fn.zTree,u=e._z.tools,i=e.consts,t=e._z.view,r=e._z.data,rt=e._z.event,f=u.$;r.exSetting(a);r.addInitBind(p);r.addInitUnBind(w);r.addInitCache(y);r.addInitNode(k);r.addInitProxy(b,!0);r.addInitRoot(v);r.addBeforeA(d);r.addZTreeTools(g);h=t.createNodes;t.createNodes=function(n,i,r,u){(h&&h.apply(t,arguments),r)&&t.repairParentChkClassWithSelf(n,u)};c=t.removeNode;t.removeNode=function(n,i){var r=i.getParentNode();(c&&c.apply(t,arguments),i&&r)&&(t.repairChkClass(n,r),t.repairParentChkClass(n,r))};l=t.appendNodes;t.appendNodes=function(n,i,u,f){var e="";return l&&(e=l.apply(t,arguments)),f&&r.makeChkFlag(n,f),e}}(jQuery),function(n){var e={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},p=function(n){var t=u.getRoot(n),i=u.getRoots();t.curEditNode=null;t.curEditInput=null;t.curHoverNode=null;t.dragFlag=0;t.dragNodeShowBefore=[];t.dragMaskList=[];i.showHoverDom=!0},w=function(){},b=function(n){var i=n.treeObj,u=t.event;i.bind(u.RENAME,function(t,i,u,f){r.apply(n.callback.onRename,[t,i,u,f])});i.bind(u.DRAG,function(t,i,u,f){r.apply(n.callback.onDrag,[i,u,f])});i.bind(u.DRAGMOVE,function(t,i,u,f){r.apply(n.callback.onDragMove,[i,u,f])});i.bind(u.DROP,function(t,i,u,f,e,o,s){r.apply(n.callback.onDrop,[i,u,f,e,o,s])})},k=function(n){var i=n.treeObj,r=t.event;i.unbind(r.RENAME);i.unbind(r.DRAG);i.unbind(r.DRAGMOVE);i.unbind(r.DROP)},d=function(n){var c=n.target,o=u.getSetting(n.data.treeId),a=n.relatedTarget,f="",l=null,e="",h=null,i=null;if(r.eqs(n.type,"mouseover")?(i=r.getMDom(o,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=r.getNodeMainDom(i).id,e="hoverOverNode")):r.eqs(n.type,"mouseout")?(i=r.getMDom(o,a,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i||(f="remove",e="hoverOutNode")):r.eqs(n.type,"mousedown")&&(i=r.getMDom(o,c,[{tagName:"a",attrName:"treeNode"+t.id.A}]),i&&(f=r.getNodeMainDom(i).id,e="mousedownNode")),f.length>0){l=u.getNodeCache(o,f);switch(e){case"mousedownNode":h=s.onMousedownNode;break;case"hoverOverNode":h=s.onHoverOverNode;break;case"hoverOutNode":h=s.onHoverOutNode}}return{stop:!1,node:l,nodeEventType:e,nodeEventCallback:h,treeEventType:"",treeEventCallback:null}},g=function(n,t,i){i&&(i.isHover=!1,i.editNameFlag=!1)},nt=function(n,e){e.cancelEditName=function(n){var t=u.getRoot(this.setting);t.curEditNode&&i.cancelCurEditNode(this.setting,n?n:null,!0)};e.copyNode=function(n,u,f,e){if(!u||n&&!n.isParent&&this.setting.data.keep.leaf&&f===t.move.TYPE_INNER)return null;var h=this,o=r.clone(u);if(n||(n=null,f=t.move.TYPE_INNER),f==t.move.TYPE_INNER){function s(){i.addNodes(h.setting,n,[o],e)}r.canAsync(this.setting,n)?i.asyncNode(this.setting,n,e,s):s()}else i.addNodes(this.setting,n.parentNode,[o],e),i.moveNode(this.setting,n,o,f,!1,e);return o};e.editName=function(n){n&&n.tId&&n===u.getNodeCache(this.setting,n.tId)&&(n.parentTId&&i.expandCollapseParentNode(this.setting,n.getParentNode(),!0),i.editNode(this.setting,n))};e.moveNode=function(n,u,e,o){function s(){i.moveNode(h.setting,n,u,e,!1,o)}if(!u)return u;if(n&&!n.isParent&&this.setting.data.keep.leaf&&e===t.move.TYPE_INNER||n&&(u.parentTId==n.tId&&e==t.move.TYPE_INNER||f(u,this.setting).find("#"+n.tId).length>0))return null;n||(n=null);var h=this;return r.canAsync(this.setting,n)&&e===t.move.TYPE_INNER?i.asyncNode(this.setting,n,o,s):s(),u};e.setEditable=function(n){return this.setting.edit.enable=n,this.refresh()}},tt={setSonNodeLevel:function(n,t,i){var r,f,e;if(i&&(r=n.data.key.children,i.level=t?t.level+1:0,i[r]))for(f=0,e=i[r].length;f<e;f++)i[r][f]&&u.setSonNodeLevel(n,i,i[r][f])}},s={onHoverOverNode:function(n,t){var r=u.getSetting(n.data.treeId),f=u.getRoot(r);if(f.curHoverNode!=t)s.onHoverOutNode(n);f.curHoverNode=t;i.addHoverDom(r,t)},onHoverOutNode:function(n){var r=u.getSetting(n.data.treeId),t=u.getRoot(r);t.curHoverNode&&!u.isSelectedNode(r,t.curHoverNode)&&(i.removeTreeDom(r,t.curHoverNode),t.curHoverNode=null)},onMousedownNode:function(o,s){function at(o){var s,ht,d,at,dt,ki,gt,ni,ti,hi,ct,vt,ot,ui,wt,bt,bi;if(w.dragFlag==0&&Math.abs(yt-o.clientX)<c.edit.drag.minMoveSize&&Math.abs(pt-o.clientY)<c.edit.drag.minMoveSize)return!0;if(ki=c.data.key.children,tt.css("cursor","pointer"),w.dragFlag==0){if(r.apply(c.callback.beforeDrag,[c.treeId,l],!0)==!1)return et(o),!0;for(s=0,ht=l.length;s<ht;s++)s==0&&(w.dragNodeShowBefore=[]),d=l[s],d.isParent&&d.open?(i.expandCollapseNode(c,d,!d.open),w.dragNodeShowBefore[d.tId]=!0):w.dragNodeShowBefore[d.tId]=!1;if(w.dragFlag=1,st.showHoverDom=!1,r.showIfameMask(c,!0),gt=!0,ni=-1,l.length>1)for(ti=l[0].parentTId?l[0].getParentNode()[ki]:u.getNodes(c),dt=[],s=0,ht=ti.length;s<ht;s++)if(w.dragNodeShowBefore[ti[s].tId]!==undefined&&(gt&&ni>-1&&ni+1!==s&&(gt=!1),dt.push(ti[s]),ni=s),l.length===dt.length){l=dt;break}for(gt&&(it=l[0].getPreNode(),rt=l[l.length-1].getNextNode()),k=f("<ul class='zTreeDragUL'><\/ul>",c),s=0,ht=l.length;s<ht;s++)(d=l[s],d.editNameFlag=!1,i.selectNode(c,d,s>0),i.removeTreeDom(c,d),s>c.edit.drag.maxShowNodeNum-1)||(at=f("<li id='"+d.tId+"_tmp'><\/li>",c),at.append(f(d,t.id.A,c).clone()),at.css("padding","0"),at.children("#"+d.tId+t.id.A).removeClass(t.node.CURSELECTED),k.append(at),s==c.edit.drag.maxShowNodeNum-1&&(at=f("<li id='"+d.tId+"_moretmp'><a>  ...  <\/a><\/li>",c),k.append(at)));k.attr("id",l[0].tId+t.id.UL+"_tmp");k.addClass(c.treeObj.attr("class"));k.appendTo(tt);p=f("<span class='tmpzTreeMove_arrow'><\/span>",c);p.attr("id","zTreeMove_arrow_tmp");p.appendTo(tt);c.treeObj.trigger(t.event.DRAG,[o,c.treeId,l])}if(w.dragFlag==1){a&&p.attr("id")==o.target.id&&v&&o.clientX+b.scrollLeft()+2>n("#"+v+t.id.A,a).offset().left?(hi=n("#"+v+t.id.A,a),o.target=hi.length>0?hi.get(0):o.target):a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER));a=null;v=null;g=!1;h=c;ct=u.getSettings();for(vt in ct)ct[vt].treeId&&ct[vt].edit.enable&&ct[vt].treeId!=c.treeId&&(o.target.id==ct[vt].treeId||n(o.target).parents("#"+ct[vt].treeId).length>0)&&(g=!0,h=ct[vt]);var ii=b.scrollTop(),ci=b.scrollLeft(),ri=h.treeObj.offset(),fr=h.treeObj.get(0).scrollHeight,er=h.treeObj.get(0).scrollWidth,li=o.clientY+ii-ri.top,ai=h.treeObj.height()+ri.top-o.clientY-ii,vi=o.clientX+ci-ri.left,yi=h.treeObj.width()+ri.left-o.clientX-ci,di=li<c.edit.drag.borderMax&&li>c.edit.drag.borderMin,gi=ai<c.edit.drag.borderMax&&ai>c.edit.drag.borderMin,nr=vi<c.edit.drag.borderMax&&vi>c.edit.drag.borderMin,tr=yi<c.edit.drag.borderMax&&yi>c.edit.drag.borderMin,or=li>c.edit.drag.borderMin&&ai>c.edit.drag.borderMin&&vi>c.edit.drag.borderMin&&yi>c.edit.drag.borderMin,sr=di&&h.treeObj.scrollTop()<=0,hr=gi&&h.treeObj.scrollTop()+h.treeObj.height()+10>=fr,cr=nr&&h.treeObj.scrollLeft()<=0,lr=tr&&h.treeObj.scrollLeft()+h.treeObj.width()+10>=er;if(o.target&&r.isChildOrSelf(o.target,h.treeId)){for(ot=o.target;ot&&ot.tagName&&!r.eqs(ot.tagName,"li")&&ot.id!=h.treeId;)ot=ot.parentNode;for(ui=!0,s=0,ht=l.length;s<ht;s++)if(d=l[s],ot.id===d.tId){ui=!1;break}else if(f(d,c).find("#"+ot.id).length>0){ui=!1;break}ui&&o.target&&r.isChildOrSelf(o.target,ot.id+t.id.A)&&(a=n(ot),v=ot.id)}if(d=l[0],or&&r.isChildOrSelf(o.target,h.treeId)&&(!a&&(o.target.id==h.treeId||sr||hr||cr||lr)&&(g||!g&&d.parentTId)&&(a=h.treeObj),di?h.treeObj.scrollTop(h.treeObj.scrollTop()-10):gi&&h.treeObj.scrollTop(h.treeObj.scrollTop()+10),nr?h.treeObj.scrollLeft(h.treeObj.scrollLeft()-10):tr&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+10),a&&a!=h.treeObj&&a.offset().left<h.treeObj.offset().left&&h.treeObj.scrollLeft(h.treeObj.scrollLeft()+a.offset().left-h.treeObj.offset().left)),k.css({top:o.clientY+ii+3+"px",left:o.clientX+ci+3+"px"}),wt=0,bt=0,a&&a.attr("id")!=h.treeId){var nt=v==null?null:u.getNodeCache(h,v),pi=(o.ctrlKey||o.metaKey)&&c.edit.drag.isMove&&c.edit.drag.isCopy||!c.edit.drag.isMove&&c.edit.drag.isCopy,ar=!!(it&&v===it.tId),vr=!!(rt&&v===rt.tId),yr=d.parentTId&&d.parentTId==v,fi=(pi||!vr)&&r.apply(h.edit.drag.prev,[h.treeId,l,nt],!!h.edit.drag.prev),ei=(pi||!ar)&&r.apply(h.edit.drag.next,[h.treeId,l,nt],!!h.edit.drag.next),wi=(pi||!yr)&&!(h.data.keep.leaf&&!nt.isParent)&&r.apply(h.edit.drag.inner,[h.treeId,l,nt],!!h.edit.drag.inner);if(fi||ei||wi){var kt=n("#"+v+t.id.A,a),ir=nt.isLastNode?null:n("#"+nt.getNextNode().tId+t.id.A,a.next()),oi=kt.offset().top,pr=kt.offset().left,rr=fi?wi?.25:ei?.5:1:-1,ur=ei?wi?.75:fi?.5:0:-1,si=(o.clientY+ii-oi)/kt.height();(rr==1||si<=rr&&si>=-.2)&&fi?(wt=1-p.width(),bt=oi-p.height()/2,y=t.move.TYPE_PREV):(ur==0||si>=ur&&si<=1.2)&&ei?(wt=1-p.width(),bt=ir==null||nt.isParent&&nt.open?oi+kt.height()-p.height()/2:ir.offset().top-p.height()/2,y=t.move.TYPE_NEXT):(wt=5-p.width(),bt=oi,y=t.move.TYPE_INNER);p.css({display:"block",top:bt+"px",left:pr+wt+"px"});kt.addClass(t.node.TMPTARGET_NODE+"_"+y);(ut!=v||ft!=y)&&(lt=(new Date).getTime());nt&&nt.isParent&&y==t.move.TYPE_INNER&&(bi=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==nt.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===nt.tId&&(bi=!1),bi&&(window.zTreeMoveTimer=setTimeout(function(){y==t.move.TYPE_INNER&&nt&&nt.isParent&&!nt.open&&(new Date).getTime()-lt>h.edit.drag.autoOpenTime&&r.apply(h.callback.beforeDragOpen,[h.treeId,nt],!0)&&(i.switchNode(h,nt),h.edit.drag.autoExpandTrigger&&h.treeObj.trigger(t.event.EXPAND,[h.treeId,nt]))},h.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=nt.tId))}else a=null,v="",y=t.move.TYPE_INNER,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}else y=t.move.TYPE_INNER,a&&r.apply(h.edit.drag.inner,[h.treeId,l,null],!!h.edit.drag.inner)?a.addClass(t.node.TMPTARGET_TREE):a=null,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);ut=v;ft=y;c.treeObj.trigger(t.event.DRAGMOVE,[o,c.treeId,l])}return!1}function et(o){var rt,ot,it,nt,d,s;if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),ut=null,ft=null,b.unbind("mousemove",at),b.unbind("mouseup",et),b.unbind("selectstart",vt),tt.css("cursor","auto"),a&&(a.removeClass(t.node.TMPTARGET_TREE),v&&n("#"+v+t.id.A,a).removeClass(t.node.TMPTARGET_NODE+"_"+t.move.TYPE_PREV).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_NEXT).removeClass(t.node.TMPTARGET_NODE+"_"+e.move.TYPE_INNER)),r.showIfameMask(c,!1),st.showHoverDom=!0,w.dragFlag!=0){for(w.dragFlag=0,rt=0,ot=l.length;rt<ot;rt++)it=l[rt],it.isParent&&w.dragNodeShowBefore[it.tId]&&!it.open&&(i.expandCollapseNode(c,it,!it.open),delete w.dragNodeShowBefore[it.tId]);if(k&&k.remove(),p&&p.remove(),nt=(o.ctrlKey||o.metaKey)&&c.edit.drag.isMove&&c.edit.drag.isCopy||!c.edit.drag.isMove&&c.edit.drag.isCopy,!nt&&a&&v&&l[0].parentTId&&v==l[0].parentTId&&y==t.move.TYPE_INNER&&(a=null),a){if(d=v==null?null:u.getNodeCache(h,v),r.apply(c.callback.beforeDrop,[h.treeId,l,d,y,nt],!0)==!1){i.selectNodes(ct,l);return}s=nt?r.clone(l):l;function ht(){if(g){if(!nt)for(var n=0,r=l.length;n<r;n++)i.removeNode(c,l[n]);if(y==t.move.TYPE_INNER)i.addNodes(h,d,s);else if(i.addNodes(h,d.getParentNode(),s),y==t.move.TYPE_PREV)for(n=0,r=s.length;n<r;n++)i.moveNode(h,d,s[n],y,!1);else for(n=-1,r=s.length-1;n<r;r--)i.moveNode(h,d,s[r],y,!1)}else if(nt&&y==t.move.TYPE_INNER)i.addNodes(h,d,s);else if(nt&&i.addNodes(h,d.getParentNode(),s),y!=t.move.TYPE_NEXT)for(n=0,r=s.length;n<r;n++)i.moveNode(h,d,s[n],y,!1);else for(n=-1,r=s.length-1;n<r;r--)i.moveNode(h,d,s[r],y,!1);i.selectNodes(h,s);f(s[0],c).focus().blur();c.treeObj.trigger(t.event.DROP,[o,h.treeId,s,d,y,nt])}y==t.move.TYPE_INNER&&r.canAsync(h,d)?i.asyncNode(h,d,!1,ht):ht()}else i.selectNodes(ct,l),c.treeObj.trigger(t.event.DROP,[o,c.treeId,l,null,null,null])}}function vt(){return!1}var d,ot,c=u.getSetting(o.data.treeId),w=u.getRoot(c),st=u.getRoots();if(o.button==2||!c.edit.enable||!c.edit.drag.isCopy&&!c.edit.drag.isMove)return!0;var ht=o.target,nt=u.getRoot(c).curSelectedList,l=[];if(u.isSelectedNode(c,s))for(d=0,ot=nt.length;d<ot;d++){if(nt[d].editNameFlag&&r.eqs(ht.tagName,"input")&&ht.getAttribute("treeNode"+t.id.INPUT)!==null)return!0;if(l.push(nt[d]),l[0].parentTId!==nt[d].parentTId){l=[s];break}}else l=[s];i.editNodeBlur=!0;i.cancelCurEditNode(c);var b=n(c.treeObj.get(0).ownerDocument),tt=n(c.treeObj.get(0).ownerDocument.body),k,p,a,g=!1,h=c,ct=c,it,rt,ut=null,ft=null,v=null,y=t.move.TYPE_INNER,yt=o.clientX,pt=o.clientY,lt=(new Date).getTime();return r.uCanDo(c)&&b.bind("mousemove",at),b.bind("mouseup",et),b.bind("selectstart",vt),o.preventDefault&&o.preventDefault(),!0}},it={getAbs:function(n){var t=n.getBoundingClientRect(),i=document.body.scrollTop+document.documentElement.scrollTop,r=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+r,t.top+i]},inputFocus:function(n){n.get(0)&&(n.focus(),r.setCursorPosition(n.get(0),n.val().length))},inputSelect:function(n){n.get(0)&&(n.focus(),n.select())},setCursorPosition:function(n,t){if(n.setSelectionRange)n.focus(),n.setSelectionRange(t,t);else if(n.createTextRange){var i=n.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",t);i.select()}},showIfameMask:function(n,t){for(var e=u.getRoot(n),o,i,h;e.dragMaskList.length>0;)e.dragMaskList[0].remove(),e.dragMaskList.shift();if(t)for(o=f("iframe",n),i=0,h=o.length;i<h;i++){var s=o.get(i),c=r.getAbs(s),l=f("<div id='zTreeMask_"+i+"' class='zTreeMask' style='top:"+c[1]+"px; left:"+c[0]+"px; width:"+s.offsetWidth+"px; height:"+s.offsetHeight+"px;'><\/div>",n);l.appendTo(f("body",n));e.dragMaskList.push(l)}}},rt={addEditBtn:function(n,u){if(!u.editNameFlag&&!(f(u,t.id.EDIT,n).length>0)&&r.apply(n.edit.showRenameBtn,[n.treeId,u],n.edit.showRenameBtn)){var e=f(u,t.id.A,n),o="<span class='"+t.className.BUTTON+" edit' id='"+u.tId+t.id.EDIT+"' title='"+r.apply(n.edit.renameTitle,[n.treeId,u],n.edit.renameTitle)+"' treeNode"+t.id.EDIT+" style='display:none;'><\/span>";e.append(o);f(u,t.id.EDIT,n).bind("click",function(){return!r.uCanDo(n)||r.apply(n.callback.beforeEditName,[n.treeId,u],!0)==!1?!1:(i.editNode(n,u),!1)}).show()}},addRemoveBtn:function(n,u){if(!u.editNameFlag&&!(f(u,t.id.REMOVE,n).length>0)&&r.apply(n.edit.showRemoveBtn,[n.treeId,u],n.edit.showRemoveBtn)){var e=f(u,t.id.A,n),o="<span class='"+t.className.BUTTON+" remove' id='"+u.tId+t.id.REMOVE+"' title='"+r.apply(n.edit.removeTitle,[n.treeId,u],n.edit.removeTitle)+"' treeNode"+t.id.REMOVE+" style='display:none;'><\/span>";e.append(o);f(u,t.id.REMOVE,n).bind("click",function(){return!r.uCanDo(n)||r.apply(n.callback.beforeRemove,[n.treeId,u],!0)==!1?!1:(i.removeNode(n,u),n.treeObj.trigger(t.event.REMOVE,[n.treeId,u]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(n,t){u.getRoots().showHoverDom&&(t.isHover=!0,n.edit.enable&&(i.addEditBtn(n,t),i.addRemoveBtn(n,t)),r.apply(n.view.addHoverDom,[n.treeId,t]))},cancelCurEditNode:function(n,e,o){var h=u.getRoot(n),a=n.data.key.name,s=h.curEditNode,c,l,v;if(s){if(c=h.curEditInput,l=e?e:o?s[a]:c.val(),r.apply(n.callback.beforeRename,[n.treeId,s,l,o],!0)===!1)return!1;s[a]=l;v=f(s,t.id.A,n);v.removeClass(t.node.CURSELECTED_EDIT);c.unbind();i.setNodeName(n,s);s.editNameFlag=!1;h.curEditNode=null;h.curEditInput=null;i.selectNode(n,s,!1);n.treeObj.trigger(t.event.RENAME,[n.treeId,s,o])}return h.noSelection=!0,!0},editNode:function(n,e){var s=u.getRoot(n),h,o;if(i.editNodeBlur=!1,u.isSelectedNode(n,e)&&s.curEditNode==e&&e.editNameFlag){setTimeout(function(){r.inputFocus(s.curEditInput)},0);return}h=n.data.key.name;e.editNameFlag=!0;i.removeTreeDom(n,e);i.cancelCurEditNode(n);i.selectNode(n,e,!1);f(e,t.id.SPAN,n).html("<input type=text class='rename' id='"+e.tId+t.id.INPUT+"' treeNode"+t.id.INPUT+" >");o=f(e,t.id.INPUT,n);o.attr("value",e[h]);n.edit.editNameSelectAll?r.inputSelect(o):r.inputFocus(o);o.bind("blur",function(){i.editNodeBlur||i.cancelCurEditNode(n)}).bind("keydown",function(t){t.keyCode=="13"?(i.editNodeBlur=!0,i.cancelCurEditNode(n)):t.keyCode=="27"&&i.cancelCurEditNode(n,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1});f(e,t.id.A,n).addClass(t.node.CURSELECTED_EDIT);s.curEditInput=o;s.noSelection=!1;s.curEditNode=e},moveNode:function(n,r,e,o,s,h){var tt=u.getRoot(n),c=n.data.key.children,l,g,p,a,b,rt,w;if(r!=e&&(!n.data.keep.leaf||!r||r.isParent||o!=t.move.TYPE_INNER)){l=e.parentTId?e.getParentNode():tt;g=r===null||r==tt;g&&r===null&&(r=tt);g&&(o=t.move.TYPE_INNER);p=r.parentTId?r.getParentNode():tt;o!=t.move.TYPE_PREV&&o!=t.move.TYPE_NEXT&&(o=t.move.TYPE_INNER);o==t.move.TYPE_INNER&&(g?e.parentTId=null:(r.isParent||(r.isParent=!0,r.open=!!r.open,i.setNodeLineIcos(n,r)),e.parentTId=r.tId));g?(a=n.treeObj,b=a):(h||o!=t.move.TYPE_INNER?h||i.expandCollapseNode(n,r.getParentNode(),!0,!1):i.expandCollapseNode(n,r,!0,!1),a=f(r,n),b=f(r,t.id.UL,n),!a.get(0)||b.get(0)||(rt=[],i.makeUlHtml(n,r,rt,""),a.append(rt.join(""))),b=f(r,t.id.UL,n));w=f(e,n);w.get(0)?a.get(0)||w.remove():w=i.appendNodes(n,e.level,[e],null,!1,!0).join("");b.get(0)&&o==t.move.TYPE_INNER?b.append(w):a.get(0)&&o==t.move.TYPE_PREV?a.before(w):a.get(0)&&o==t.move.TYPE_NEXT&&a.after(w);var v,it,k=-1,nt=0,d=null,y=null,ut=e.level;if(e.isFirstNode)k=0,l[c].length>1&&(d=l[c][1],d.isFirstNode=!0);else if(e.isLastNode)k=l[c].length-1,d=l[c][k-1],d.isLastNode=!0;else for(v=0,it=l[c].length;v<it;v++)if(l[c][v].tId==e.tId){k=v;break}if(k>=0&&l[c].splice(k,1),o!=t.move.TYPE_INNER)for(v=0,it=p[c].length;v<it;v++)p[c][v].tId==r.tId&&(nt=v);if(o==t.move.TYPE_INNER?(r[c]||(r[c]=[]),r[c].length>0&&(y=r[c][r[c].length-1],y.isLastNode=!1),r[c].splice(r[c].length,0,e),e.isLastNode=!0,e.isFirstNode=r[c].length==1):r.isFirstNode&&o==t.move.TYPE_PREV?(p[c].splice(nt,0,e),y=r,y.isFirstNode=!1,e.parentTId=r.parentTId,e.isFirstNode=!0,e.isLastNode=!1):r.isLastNode&&o==t.move.TYPE_NEXT?(p[c].splice(nt+1,0,e),y=r,y.isLastNode=!1,e.parentTId=r.parentTId,e.isFirstNode=!1,e.isLastNode=!0):(o==t.move.TYPE_PREV?p[c].splice(nt,0,e):p[c].splice(nt+1,0,e),e.parentTId=r.parentTId,e.isFirstNode=!1,e.isLastNode=!1),u.fixPIdKeyValue(n,e),u.setSonNodeLevel(n,e.getParentNode(),e),i.setNodeLineIcos(n,e),i.repairNodeLevelClass(n,e,ut),!n.data.keep.parent&&l[c].length<1){l.isParent=!1;l.open=!1;var ft=f(l,t.id.UL,n),et=f(l,t.id.SWITCH,n),ot=f(l,t.id.ICON,n);i.replaceSwitchClass(l,et,t.folder.DOCU);i.replaceIcoClass(l,ot,t.folder.DOCU);ft.css("display","none")}else d&&i.setNodeLineIcos(n,d);y&&i.setNodeLineIcos(n,y);!!n.check&&n.check.enable&&i.repairChkClass&&(i.repairChkClass(n,l),i.repairParentChkClassWithSelf(n,l),l!=e.parent&&i.repairParentChkClassWithSelf(n,e));h||i.expandCollapseParentNode(n,e.getParentNode(),!0,s)}},removeEditBtn:function(n,i){f(i,t.id.EDIT,n).unbind().remove()},removeRemoveBtn:function(n,i){f(i,t.id.REMOVE,n).unbind().remove()},removeTreeDom:function(n,t){t.isHover=!1;i.removeEditBtn(n,t);i.removeRemoveBtn(n,t);r.apply(n.view.removeHoverDom,[n.treeId,t])},repairNodeLevelClass:function(n,i,r){if(r!==i.level){var o=f(i,n),s=f(i,t.id.A,n),h=f(i,t.id.UL,n),u=t.className.LEVEL+r,e=t.className.LEVEL+i.level;o.removeClass(u);o.addClass(e);s.removeClass(u);s.addClass(e);h.removeClass(u);h.addClass(e)}},selectNodes:function(n,t){for(var r=0,u=t.length;r<u;r++)i.selectNode(n,t[r],r>0)}},ut={tools:it,view:rt,event:{},data:tt},h,c,y,l,a,v;n.extend(!0,n.fn.zTree.consts,e);n.extend(!0,n.fn.zTree._z,ut);var o=n.fn.zTree,r=o._z.tools,t=o.consts,i=o._z.view,u=o._z.data,ft=o._z.event,f=r.$;u.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}});u.addInitBind(b);u.addInitUnBind(k);u.addInitCache(w);u.addInitNode(g);u.addInitProxy(d);u.addInitRoot(p);u.addZTreeTools(nt);h=i.cancelPreSelectedNode;i.cancelPreSelectedNode=function(n,t){for(var f=u.getRoot(n).curSelectedList,r=0,e=f.length;r<e;r++)if((!t||t===f[r])&&(i.removeTreeDom(n,f[r]),t))break;h&&h.apply(i,arguments)};c=i.createNodes;i.createNodes=function(n,t,r,u){(c&&c.apply(i,arguments),r)&&i.repairParentChkClassWithSelf&&i.repairParentChkClassWithSelf(n,u)};y=i.makeNodeUrl;i.makeNodeUrl=function(n){return n.edit.enable?null:y.apply(i,arguments)};l=i.removeNode;i.removeNode=function(n,t){var r=u.getRoot(n);r.curEditNode===t&&(r.curEditNode=null);l&&l.apply(i,arguments)};a=i.selectNode;i.selectNode=function(n,t){var r=u.getRoot(n);return u.isSelectedNode(n,t)&&r.curEditNode==t&&t.editNameFlag?!1:(a&&a.apply(i,arguments),i.addHoverDom(n,t),!0)};v=r.uCanDo;r.uCanDo=function(n,t){var f=u.getRoot(n);return t&&(r.eqs(t.type,"mouseover")||r.eqs(t.type,"mouseout")||r.eqs(t.type,"mousedown")||r.eqs(t.type,"mouseup"))?!0:(f.curEditNode&&(i.editNodeBlur=!1,f.curEditInput.focus()),!f.curEditNode&&(v?v.apply(i,arguments):!0))}}(jQuery);
//# sourceMappingURL=jquery.ztree.all-3.5.min.js.map
